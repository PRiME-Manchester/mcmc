<!DOCTYPE html>
<!-- saved from url=(0087)https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/ -->
<html lang="en" class="js"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script async="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/count.json"></script><script async="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/count(1).json"></script>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="pingback" href="https://darrenjw.wordpress.com/xmlrpc.php">
	<!--[if lt IE 9]>
	<script src="https://s0.wp.com/wp-content/themes/pub/twentyfifteen/js/html5.js"></script>
	<![endif]-->
	<script>(function(html){html.className = html.className.replace(/\bno-js\b/,'js')})(document.documentElement);</script>
<title>Gibbs sampler in various languages (revisited) | Darren Wilkinson's research blog</title>
<link rel="alternate" type="application/rss+xml" title="Darren Wilkinson&#39;s research blog » Feed" href="https://darrenjw.wordpress.com/feed/">
<link rel="alternate" type="application/rss+xml" title="Darren Wilkinson&#39;s research blog » Comments Feed" href="https://darrenjw.wordpress.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Darren Wilkinson&#39;s research blog » Gibbs sampler in various languages (revisited) Comments Feed" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/feed/">
<script type="text/javascript">
/* <![CDATA[ */
function addLoadEvent(func){var oldonload=window.onload;if(typeof window.onload!='function'){window.onload=func;}else{window.onload=function(){oldonload();func();}}}
/* ]]> */
</script>
<link rel="stylesheet" id="all-css-0" href="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/saved_resource" type="text/css" media="all">
<link rel="stylesheet" id="twentyfifteen-fonts-css" href="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/css" type="text/css" media="all">
<link rel="stylesheet" id="all-css-2" href="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/saved_resource(1)" type="text/css" media="all">
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentyfifteen-ie-css'  href='https://s0.wp.com/wp-content/themes/pub/twentyfifteen/css/ie.css?m=1421363535g&#038;ver=20141010' type='text/css' media='all' />
<![endif]-->
<!--[if lt IE 8]>
<link rel='stylesheet' id='twentyfifteen-ie7-css'  href='https://s0.wp.com/wp-content/themes/pub/twentyfifteen/css/ie7.css?m=1418225460g&#038;ver=20141010' type='text/css' media='all' />
<![endif]-->
<link rel="stylesheet" id="all-css-6" href="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/saved_resource(2)" type="text/css" media="all">
<script type="text/javascript">
/* <![CDATA[ */
var LoggedOutFollow = {"invalid_email":"Your subscription did not succeed, please try again with a valid email address."};
/* ]]> */
</script><style type="text/css"></style>
<script type="text/javascript" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/saved_resource(3)"></script>
<link rel="stylesheet" id="all-css-0" href="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/style.css" type="text/css" media="all">
<!--[if lt IE 8]>
<link rel='stylesheet' id='highlander-comments-ie7-css'  href='https://s2.wp.com/wp-content/mu-plugins/highlander-comments/style-ie7.css?m=1351637563g&#038;ver=20110606' type='text/css' media='all' />
<![endif]-->
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://darrenjw.wordpress.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://s1.wp.com/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Java math libraries and Monte Carlo simulation codes" href="https://darrenjw.wordpress.com/2011/06/04/java-math-libraries-and-monte-carlo-simulation-codes/">
<link rel="next" title="Faster Gibbs sampling MCMC from within R" href="https://darrenjw.wordpress.com/2011/07/31/faster-gibbs-sampling-mcmc-from-within-r/">
<meta name="generator" content="WordPress.com">
<link rel="canonical" href="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog.html">
<link rel="shortlink" href="http://wp.me/pB0wL-8B">
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/1.0/?format=json&url=https%3A%2F%2Fdarrenjw.wordpress.com%2F2011%2F07%2F16%2Fgibbs-sampler-in-various-languages-revisited%2F&for=wpcom-auto-discovery"><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/1.0/?format=xml&url=https%3A%2F%2Fdarrenjw.wordpress.com%2F2011%2F07%2F16%2Fgibbs-sampler-in-various-languages-revisited%2F&for=wpcom-auto-discovery">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article">
<meta property="og:title" content="Gibbs sampler in various languages (revisited)">
<meta property="og:url" content="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/">
<meta property="og:description" content="Introduction Regular readers of this blog will know that in April 2010 I published a short post showing how a trivial bivariate Gibbs sampler could be implemented in the four languages that I use m...">
<meta property="article:published_time" content="2011-07-16T15:03:42+00:00">
<meta property="article:modified_time" content="2014-11-12T16:29:03+00:00">
<meta property="og:site_name" content="Darren Wilkinson&#39;s research blog">
<meta property="og:image" content="https://s0.wp.com/i/blank.jpg">
<meta property="og:locale" content="en_US">
<meta name="twitter:site" content="@wordpressdotcom">
<meta name="twitter:card" content="summary">
<meta property="fb:app_id" content="249643311490">
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom">
<link rel="shortcut icon" type="image/x-icon" href="https://s2.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48">
<link rel="icon" type="image/x-icon" href="https://s2.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48">
<link rel="apple-touch-icon-precomposed" href="https://s0.wp.com/i/webclip.png">
<link rel="openid.server" href="https://darrenjw.wordpress.com/?openidserver=1">
<link rel="openid.delegate" href="https://darrenjw.wordpress.com/">
<link rel="search" type="application/opensearchdescription+xml" href="https://darrenjw.wordpress.com/osd.xml" title="Darren Wilkinson&#39;s research blog">
<link rel="search" type="application/opensearchdescription+xml" href="https://wordpress.com/opensearch.xml" title="WordPress.com">
<style type="text/css">
.widget_twitter li {
	word-wrap: break-word;
}
</style>
<meta name="application-name" content="Darren Wilkinson&#39;s research blog"><meta name="msapplication-window" content="width=device-width;height=device-height"><meta name="msapplication-tooltip" content="Statistics, computing, data science, Bayes, stochastic modelling, systems biology and bioinformatics"><meta name="msapplication-task" content="name=Subscribe;action-uri=https://darrenjw.wordpress.com/feed/;icon-uri=https://s2.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=https://s2.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=https://s2.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=https://s2.wp.com/i/favicon.ico"><meta name="title" content="Gibbs sampler in various languages (revisited) | Darren Wilkinson&#39;s research blog on WordPress.com">
<meta name="description" content="Introduction Regular readers of this blog will know that in April 2010 I published a short post showing how a trivial bivariate Gibbs sampler could be implemented in the four languages that I use most often these days (R, python, C, Java), and I discussed relative timings, and how one might start to think about…">
		<script type="text/javascript" src="https://c.amazon-adsystem.com/aax2/amzn_ads.js"></script>
		<script type="text/javascript">
		try { amznads.getAds("3033"); } catch(e) { /* ignore */ }
		</script>
		<script type="text/javascript">
		var a9_p = amznads.getKeys(),
		_ipw_custom = {
			wordAds: '0',
			adSafe: '1',
			domain: 'darrenjw.wordpress.com',
			pageURL: 'https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/'
		};
		if("undefined"!=typeof a9_p&&""!=a9_p&&null!==a9_p&&"[object Array]"===Object.prototype.toString.call(a9_p)){var a="",b=0,c=a9_p.length;a9_p.sort();for(var d=0;d<c;d++){a9_p[d-b]=a9_p[d-b].replace(/a1x6p/,"a160x600p");var e=a9_p[d-b].split("p");e[0]==a&&(a9_p.splice(d-b,1),b++);a=e[0]}_ipw_custom.amznPay=a9_p};document.close();
		</script>		<!-- IPONWEB header script -->
		<script type="text/javascript">
			window.__ATA = {
				scriptSrc: '//s.pubmine.com/showad.js',
				slotPrefix: 'automattic-id-',
				initAd: function(o) {
					var o = o || {},
						g = window,
						d = g.document,
						wr = d.write,
						id = g.__ATA.id();
					wr.call(d, '<div id="' + id + '" data-section="' + (o.sectionId || 0) + '"' + (o.type ? ('data-type="' + o.type + '"') : '') + ' ' + (o.forcedUrl ? ('data-forcedurl="' + o.forcedUrl + '"') : '') + ' style="width:' + (o.width || 0) + 'px; height:' + (o.height || 0) + 'px;">');
					g.__ATA.displayAd(id);
					wr.call(d, '</div>');
				},
				displayAd: function(id) {
					window.__ATA.ids = window.__ATA.ids || {};
					window.__ATA.ids[id] = 1;
				},
				customParams: _ipw_custom,
				id: function() {
					return window.__ATA.slotPrefix + (parseInt(Math.random() * 10000, 10) + 1 + (new Date()).getMilliseconds());
				}
			};
			(function(d, ata) {
				var pr = "https:" === d.location.protocol ? "https:" : "http:",
					src = pr + ata.scriptSrc,
					st = "text/javascript";
				d.write('<scr' + 'ipt type="' + st + '" src="' + src + '"><\/scr' + 'ipt>');
			})(window.document, window.__ATA);
		</script><script type="text/javascript" src="https://s.pubmine.com/showad.js"></script>
		<script type="text/javascript">
		jQuery(window).ready(function () {
			jQuery("a.wpa-about").text("About these ads");
		});
		</script><link rel="stylesheet" type="text/css" href="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/shCore.css"><link rel="stylesheet" type="text/css" href="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/shThemeDefault.css"><style type="text/css" id="syntaxhighlighteranchor"></style>
<script type="text/javascript">
	window.google_analytics_uacct = "UA-52447-2";
</script>

<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-52447-2']);
	_gaq.push(['_setDomainName', 'wordpress.com']);
	_gaq.push(['_initData']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})();
</script><script type="text/javascript" async="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/ga.js"></script>
<link rel="stylesheet" type="text/css" id="gravatar-card-css" href="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/hovercard.css"><link rel="stylesheet" type="text/css" id="gravatar-card-services-css" href="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/services.css"></head>

<body class="single single-post postid-533 single-format-standard mp6 customizer-styles-applied highlander-enabled highlander-light"><div id="StayFocusd-infobar" style="display: none; top: 0px;">
    <img src="chrome-extension://laankejkbhbdhmipfmgcngdelahlfoji/common/img/eye_19x19_red.png">
    <span id="StayFocusd-infobar-msg"></span>
    <span id="StayFocusd-infobar-links">
        <a id="StayFocusd-infobar-never-show">hide forever</a>&nbsp;&nbsp;|&nbsp;&nbsp;
        <a id="StayFocusd-infobar-hide">hide once</a>
    </span>
</div>
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#content">Skip to content</a>

	<div id="sidebar" class="sidebar" style="position: fixed;">
		<header id="masthead" class="site-header" role="banner">
			<div class="site-branding">
										<p class="site-title"><a href="https://darrenjw.wordpress.com/" rel="home">Darren Wilkinson's research blog</a></p>
											<p class="site-description">Statistics, computing, data science, Bayes, stochastic modelling, systems biology and bioinformatics</p>
									<button class="secondary-toggle">Menu and widgets</button>
			</div><!-- .site-branding -->
		</header><!-- .site-header -->

			<div id="secondary" class="secondary">

		
		
					<div id="widget-area" class="widget-area" role="complementary">
				<aside id="rss_links-3" class="widget widget_rss_links"><h2 class="widget-title">Feeds for this blog</h2><ul><li><a href="https://darrenjw.wordpress.com/feed/" title="Subscribe to Posts">RSS - Posts</a></li><li><a href="https://darrenjw.wordpress.com/comments/feed/" title="Subscribe to Comments">RSS - Comments</a></li></ul>
</aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h2 class="widget-title">Recent Posts</h2>		<ul>
					<li>
				<a href="https://darrenjw.wordpress.com/2015/11/16/hofs-closures-partial-application-and-currying-to-solve-the-function-environment-problem-in-scala/">HOFs, closures, partial application and currying to solve the function environment problem in&nbsp;Scala</a>
						</li>
					<li>
				<a href="https://darrenjw.wordpress.com/2015/08/21/data-frames-and-tables-in-scala/">Data frames and tables in&nbsp;Scala</a>
						</li>
					<li>
				<a href="https://darrenjw.wordpress.com/2015/08/15/calling-r-from-scala-sbt-projects-using-rscala/">Calling R from Scala sbt projects using&nbsp;rscala</a>
						</li>
					<li>
				<a href="https://darrenjw.wordpress.com/2015/08/15/calling-scala-code-from-r-using-rscala/">Calling Scala code from R using&nbsp;rscala</a>
						</li>
					<li>
				<a href="https://darrenjw.wordpress.com/2015/04/10/index-to-first-50-posts/">Index to first 50&nbsp;posts</a>
						</li>
					<li>
				<a href="https://darrenjw.wordpress.com/2015/04/09/scala-for-machine-learning-book-review/">Scala for Machine Learning [book&nbsp;review]</a>
						</li>
					<li>
				<a href="https://darrenjw.wordpress.com/2015/01/24/calling-r-from-scala-sbt-projects/">Calling R from Scala sbt&nbsp;projects</a>
						</li>
					<li>
				<a href="https://darrenjw.wordpress.com/2015/01/03/inlining-scala-breeze-code-in-r-using-jvmr-and-sbt/">Inlining Scala Breeze code in R using jvmr and&nbsp;sbt</a>
						</li>
				</ul>
		</aside>		<aside id="twitter-3" class="widget widget_twitter"><h2 class="widget-title"><a href="http://twitter.com/darrenjw">@darrenjw’s twitter feed</a></h2><ul class="tweets">
			<li>
				RT @<a href="http://twitter.com/LinuxVoice">LinuxVoice</a>: Crikey! There's a new Raspberry Pi on sale, and it's just $5 or £4! What a time to be alive: <a href="https://www.raspberrypi.org/blog/raspberry-pi-zero/"> raspberrypi.org/blog/raspberry…</a> https:… 				<a href="http://twitter.com/darrenjw/statuses/669804369009885185" class="timesince">6&nbsp;days&nbsp;ago</a>
			</li>

			
			<li>
				RT @<a href="http://twitter.com/BBSRC">BBSRC</a>: We're reviewing <a href="http://twitter.com/search?q=%23bioscience">#bioscience</a> imaging &amp; want to hear from <a href="http://twitter.com/search?q=%23research">#research</a> community. Deadline Dec 18 <a href="http://ht.ly/UT9bz"> ht.ly/UT9bz</a> <a href="https://t.c%E2%80%A6/" rel="nofollow">https://t.c…</a> 				<a href="http://twitter.com/darrenjw/statuses/667804970729738240" class="timesince">1&nbsp;week&nbsp;ago</a>
			</li>

			
			<li>
				RT @<a href="http://twitter.com/mcallister_d">mcallister_d</a>: Calling all @<a href="http://twitter.com/BBSRC">BBSRC</a> <a href="http://twitter.com/search?q=%23postdocs">#postdocs</a>! We want to hear your views on modelling + stats + comp skills needed for <a href="http://twitter.com/search?q=%23bioscience">#bioscience</a> https:… 				<a href="http://twitter.com/darrenjw/statuses/667365840099123200" class="timesince">1&nbsp;week&nbsp;ago</a>
			</li>

			
			<li>
				RT @<a href="http://twitter.com/FP_North_East">FP_North_East</a>: Full house for the first FP North East. Big thanks to Newcastle university digital institute and Opencast software https… 				<a href="http://twitter.com/darrenjw/statuses/666979741149306880" class="timesince">2&nbsp;weeks&nbsp;ago</a>
			</li>

			
			<li>
				HOFs, closures, partial application and currying to solve the function environment problem in <a href="http://twitter.com/search?q=%23Scala">#Scala</a> - <a href="http://wp.me/pB0wL-qv"> wp.me/pB0wL-qv</a> 				<a href="http://twitter.com/darrenjw/statuses/666294993921957888" class="timesince">2&nbsp;weeks&nbsp;ago</a>
			</li>

			</ul></aside><aside id="jp_blogs_i_follow-2" class="widget widget_jp_blogs_i_follow"><h2 class="widget-title">Blogs I Follow</h2><ol><li><a href="http://kbroman.wordpress.com/" class="bump-view" data-bump-view="bif">The stupidest thing...</a></li><li><a href="http://radfordneal.wordpress.com/" class="bump-view" data-bump-view="bif">Radford Neal's blog</a></li><li><a href="http://johncarlosbaez.wordpress.com/" class="bump-view" data-bump-view="bif">Azimuth</a></li><li><a href="http://xianblog.wordpress.com/" class="bump-view" data-bump-view="bif">Xi'an's Og</a></li><li><a href="http://normaldeviate.wordpress.com/" class="bump-view" data-bump-view="bif">Normal Deviate</a></li></ol></aside><aside id="nav_menu-3" class="widget widget_nav_menu"><h2 class="widget-title">About</h2><div class="menu-pages-container"><ul id="menu-pages" class="menu"><li id="menu-item-1589" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1589"><a href="https://darrenjw.wordpress.com/about/">Darren Wilkinson</a></li></ul></div></aside>			</div><!-- .widget-area -->
		
	</div><!-- .secondary -->

	</div><!-- .sidebar -->

	<div id="content" class="site-content">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
<article id="post-533" class="post-533 post type-post status-publish format-standard hentry category-uncategorized tag-byte-code tag-c tag-colt tag-gibbs tag-groovy tag-gsl tag-java tag-mcmc tag-parallel tag-programming tag-pypy tag-python tag-r tag-random tag-rcpp tag-relative tag-rjava tag-sampler tag-scala tag-speed tag-timings">
	
	<header class="entry-header">
		<h1 class="entry-title">Gibbs sampler in various languages&nbsp;(revisited)</h1>	</header><!-- .entry-header -->

	<div class="entry-content">
		<h3>Introduction</h3>
<p>Regular readers of this blog will know that in April 2010 I published a short post showing how a trivial bivariate Gibbs sampler could be implemented in the four languages that I use most often these days (R, python, C, Java), and I discussed relative timings, and how one might start to think about trading off development time against execution time for more complex MCMC algorithms. I actually wrote the post very quickly one night while I was stuck in a hotel room in Seattle – I didn’t give much thought to it, and the main purpose was to provide simple illustrative examples of simple Monte Carlo codes using non-uniform random number generators in the different languages, as a starting point for someone thinking of switching languages (say, from R to Java or C, for efficiency reasons). It wasn’t meant to be very deep or provocative, or to start any language wars. Suffice to say that this post has had many more hits than all of my other posts combined, is still my most popular post, and still attracts comments and spawns other posts to this day. Several people have requested that I re-do the post more carefully, to include actual timings, and to include a few additional optimisations. Hence this post. For reference, the original post is <a href="https://darrenjw.wordpress.com/2010/04/28/mcmc-programming-in-r-python-java-and-c/">here</a>. A post about it from the python community is <a href="http://pyinsci.blogspot.com/2010/12/efficcient-mcmc-in-python.html">here</a>, and a recent post about using Rcpp and inlined C++ code to speed up the R version is <a href="http://dirk.eddelbuettel.com/blog/2011/07/14/#rcpp_gibbs_example">here</a>.</p>
<h3>The sampler</h3>
<p>So, the basic idea was to construct a Gibbs sampler for the bivariate distribution</p>
<p><img src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/latex.php" alt="f(x,y) = kx^2\exp\{-xy^2-y^2+2y-4x\},\qquad x&gt;0,y\in\Bbb{R}" title="f(x,y) = kx^2\exp\{-xy^2-y^2+2y-4x\},\qquad x&gt;0,y\in\Bbb{R}" class="latex"></p>
<p>with unknown normalising constant <img src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/latex(1).php" alt="k&gt;0" title="k&gt;0" class="latex"> ensuring that the density integrates to one. Unfortunately, in the original post I dropped a factor of 2 constructing one of the full conditionals, which meant that none of the samplers actually had exactly the right target distribution (thanks to Sanjog Misra for bringing this to my attention). So actually, the correct full conditionals are</p>
<p><img src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/latex(2).php" alt="\displaystyle x|y \sim Ga(3,y^2+4) " title="\displaystyle x|y \sim Ga(3,y^2+4) " class="latex"></p>
<p><img src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/latex(3).php" alt="\displaystyle y|x \sim N\left(\frac{1}{1+x},\frac{1}{2(1+x)}\right) " title="\displaystyle y|x \sim N\left(\frac{1}{1+x},\frac{1}{2(1+x)}\right) " class="latex"></p>
<p>Note the factor of two in the variance of the full conditional for <img src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/latex(4).php" alt="y" title="y" class="latex">. Given the full conditionals, it is simple to alternately sample from them to construct a Gibbs sampler for the target distribution. We will run a Gibbs sampler with a thin of 1000 and obtain a final sample of 50000.</p>
<h3>Implementations</h3>
<h4>R</h4>
<p>Let’s start with <a href="http://www.r-project.org/">R</a> again. The slightly modified version of the code from the old post is given below</p>
<div><div id="highlighter_841688" class="syntaxhighlighter  r "><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="r plain">gibbs=</code><code class="r keyword">function</code><code class="r plain">(N,thin)</code></div><div class="line number2 index1 alt1"><code class="r plain">{</code></div><div class="line number3 index2 alt2"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r plain">mat=</code><code class="r functions">matrix</code><code class="r plain">(0,ncol=3,nrow=N)</code></div><div class="line number4 index3 alt1"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r plain">mat[,1]=1:N</code></div><div class="line number5 index4 alt2"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r plain">x=0</code></div><div class="line number6 index5 alt1"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r plain">y=0</code></div><div class="line number7 index6 alt2"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r functions">for </code><code class="r plain">(i </code><code class="r keyword">in</code> <code class="r plain">1:N) {</code></div><div class="line number8 index7 alt1"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r functions">for </code><code class="r plain">(j </code><code class="r keyword">in</code> <code class="r plain">1:thin) {</code></div><div class="line number9 index8 alt2"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r plain">x=</code><code class="r functions">rgamma</code><code class="r plain">(1,3,y*y+4)</code></div><div class="line number10 index9 alt1"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r plain">y=</code><code class="r functions">rnorm</code><code class="r plain">(1,1/(x+1),1/</code><code class="r functions">sqrt</code><code class="r plain">(2*x+2))</code></div><div class="line number11 index10 alt2"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r plain">}</code></div><div class="line number12 index11 alt1"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r plain">mat[i,2:3]=</code><code class="r functions">c</code><code class="r plain">(x,y)</code></div><div class="line number13 index12 alt2"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r plain">}</code></div><div class="line number14 index13 alt1"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r plain">mat=</code><code class="r functions">data.frame</code><code class="r plain">(mat)</code></div><div class="line number15 index14 alt2"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r functions">names</code><code class="r plain">(mat)=</code><code class="r functions">c</code><code class="r plain">(</code><code class="r string">"Iter"</code><code class="r plain">,</code><code class="r string">"x"</code><code class="r plain">,</code><code class="r string">"y"</code><code class="r plain">)</code></div><div class="line number16 index15 alt1"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r plain">mat</code></div><div class="line number17 index16 alt2"><code class="r plain">}</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="r plain">writegibbs=</code><code class="r keyword">function</code><code class="r plain">(N=50000,thin=1000)</code></div><div class="line number20 index19 alt1"><code class="r plain">{</code></div><div class="line number21 index20 alt2"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r plain">mat=</code><code class="r functions">gibbs</code><code class="r plain">(N,thin)</code></div><div class="line number22 index21 alt1"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r functions">write.table</code><code class="r plain">(mat,</code><code class="r string">"data.tab"</code><code class="r plain">,row.names=</code><code class="r keyword">FALSE</code><code class="r plain">)</code></div><div class="line number23 index22 alt2"><code class="r plain">}</code></div><div class="line number24 index23 alt1">&nbsp;</div><div class="line number25 index24 alt2"><code class="r functions">writegibbs</code><code class="r plain">()</code></div></div></td></tr></tbody></table></div></div>
<p>I’ve just corrected the full conditional, and I’ve increased the sample size and thinning to 50k and 1k, respectively, to allow for more accurate timings (of the faster languages). This code can be run from the (Linux) command line with something like:</p>
<div><div id="highlighter_581412" class="syntaxhighlighter nogutter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash functions">time</code> <code class="bash plain">Rscript gibbs.R</code></div></div></td></tr></tbody></table></div></div>
<p>I discuss timings in detail towards the end of the post, but this code is slow, taking over 7 minutes on my (very fast) laptop. Now, the above code is typical of the way code is often structured in R – doing as much as possible in memory, and writing to disk only if necessary. However, this can be a bad idea with large MCMC codes, and is less natural in other languages, anyway, so below is an alternative version of the code, written in more of a scripting language style.</p>
<div><div id="highlighter_975248" class="syntaxhighlighter  r"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="r plain">gibbs=</code><code class="r functions">function</code><code class="r plain">(N,thin)</code></div><div class="line number2 index1 alt1"><code class="r plain">{</code></div><div class="line number3 index2 alt2"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r plain">x=0</code></div><div class="line number4 index3 alt1"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r plain">y=0</code></div><div class="line number5 index4 alt2"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r functions">cat</code><code class="r plain">(</code><code class="r functions">paste</code><code class="r plain">(</code><code class="r string">"Iter"</code><code class="r plain">,</code><code class="r string">"x"</code><code class="r plain">,</code><code class="r string">"y"</code><code class="r plain">,</code><code class="r string">"\n"</code><code class="r plain">))</code></div><div class="line number6 index5 alt1"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r functions">for </code><code class="r plain">(i </code><code class="r keyword">in</code> <code class="r plain">1:N) {</code></div><div class="line number7 index6 alt2"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r functions">for </code><code class="r plain">(j </code><code class="r keyword">in</code> <code class="r plain">1:thin) {</code></div><div class="line number8 index7 alt1"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r plain">x=</code><code class="r functions">rgamma</code><code class="r plain">(1,3,y*y+4)</code></div><div class="line number9 index8 alt2"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r plain">y=</code><code class="r functions">rnorm</code><code class="r plain">(1,1/(x+1),1/</code><code class="r functions">sqrt</code><code class="r plain">(2*x+2))</code></div><div class="line number10 index9 alt1"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r plain">}</code></div><div class="line number11 index10 alt2"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r functions">cat</code><code class="r plain">(</code><code class="r functions">paste</code><code class="r plain">(i,x,y,</code><code class="r string">"\n"</code><code class="r plain">))</code></div><div class="line number12 index11 alt1"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r plain">}</code></div><div class="line number13 index12 alt2"><code class="r plain">}</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="r functions">gibbs</code><code class="r plain">(50000,1000)</code></div></div></td></tr></tbody></table></div></div>
<p>This can be run with a command like</p>
<div><div id="highlighter_646739" class="syntaxhighlighter nogutter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash functions">time</code> <code class="bash plain">Rscript gibbs-script.R &gt; data.tab</code></div></div></td></tr></tbody></table></div></div>
<p>This code actually turns out to be a slightly slower than the in-memory version for this simple example, but for larger problems I would not expect that to be the case. I always analyse MCMC output using R, whatever language I use for running the algorithm, so for completeness, here is a bit of code to load up the data file, do some plots and compute summary statistics.</p>
<div><div id="highlighter_783434" class="syntaxhighlighter  r"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="r plain">fun=</code><code class="r functions">function</code><code class="r plain">(x,y)</code></div><div class="line number2 index1 alt1"><code class="r plain">{</code></div><div class="line number3 index2 alt2"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r plain">x*x*</code><code class="r functions">exp</code><code class="r plain">(-x*y*y-y*y+2*y-4*x)</code></div><div class="line number4 index3 alt1"><code class="r plain">}</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="r plain">compare&lt;-</code><code class="r keyword">function</code><code class="r plain">(file=</code><code class="r string">"data.tab"</code><code class="r plain">)</code></div><div class="line number7 index6 alt2"><code class="r plain">{</code></div><div class="line number8 index7 alt1"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r plain">mat=</code><code class="r functions">read.table</code><code class="r plain">(file,header=</code><code class="r keyword">TRUE</code><code class="r plain">)</code></div><div class="line number9 index8 alt2"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r plain">op=</code><code class="r functions">par</code><code class="r plain">(mfrow=</code><code class="r functions">c</code><code class="r plain">(2,1))</code></div><div class="line number10 index9 alt1"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r plain">x=</code><code class="r functions">seq</code><code class="r plain">(0,3,0.1)</code></div><div class="line number11 index10 alt2"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r plain">y=</code><code class="r functions">seq</code><code class="r plain">(-1,3,0.1)</code></div><div class="line number12 index11 alt1"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r plain">z=</code><code class="r functions">outer</code><code class="r plain">(x,y,fun)</code></div><div class="line number13 index12 alt2"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r functions">contour</code><code class="r plain">(x,y,z,main=</code><code class="r string">"Contours of actual (unnormalised) distribution"</code><code class="r plain">)</code></div><div class="line number14 index13 alt1"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r functions">require</code><code class="r plain">(KernSmooth)</code></div><div class="line number15 index14 alt2"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r plain">fit=</code><code class="r functions">bkde2D</code><code class="r plain">(</code><code class="r functions">as.matrix</code><code class="r plain">(mat[,2:3]),</code><code class="r functions">c</code><code class="r plain">(0.1,0.1))</code></div><div class="line number16 index15 alt1"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r functions">contour</code><code class="r plain">(fit$x1,fit$x2,fit$fhat,main=</code><code class="r string">"Contours of empirical distribution"</code><code class="r plain">)</code></div><div class="line number17 index16 alt2"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r functions">par</code><code class="r plain">(op)</code></div><div class="line number18 index17 alt1"><code class="r spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="r functions">print</code><code class="r plain">(</code><code class="r functions">summary</code><code class="r plain">(mat[,2:3]))</code></div><div class="line number19 index18 alt2"><code class="r plain">}</code></div><div class="line number20 index19 alt1"><code class="r functions">compare</code><code class="r plain">()</code></div></div></td></tr></tbody></table></div></div>
<h4>Python</h4>
<p>Another language I use a lot is <a href="http://www.python.org/">Python</a>. I don’t want to start any language wars, but I personally find python to be a better designed language than R, and generally much nicer for the development of large programs. A python script for this problem is given below</p>
<div><div id="highlighter_457012" class="syntaxhighlighter  python"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">import</code> <code class="python plain">random,math</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="python keyword">def</code> <code class="python plain">gibbs(N</code><code class="python keyword">=</code><code class="python value">50000</code><code class="python plain">,thin</code><code class="python keyword">=</code><code class="python value">1000</code><code class="python plain">):</code></div><div class="line number4 index3 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">x</code><code class="python keyword">=</code><code class="python value">0</code></div><div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">y</code><code class="python keyword">=</code><code class="python value">0</code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python string">"Iter&nbsp; x&nbsp; y"</code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code> <code class="python plain">i </code><code class="python keyword">in</code> <code class="python functions">range</code><code class="python plain">(N):</code></div><div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code> <code class="python plain">j </code><code class="python keyword">in</code> <code class="python functions">range</code><code class="python plain">(thin):</code></div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">x</code><code class="python keyword">=</code><code class="python plain">random.gammavariate(</code><code class="python value">3</code><code class="python plain">,</code><code class="python value">1.0</code><code class="python keyword">/</code><code class="python plain">(y</code><code class="python keyword">*</code><code class="python plain">y</code><code class="python keyword">+</code><code class="python value">4</code><code class="python plain">))</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">y</code><code class="python keyword">=</code><code class="python plain">random.gauss(</code><code class="python value">1.0</code><code class="python keyword">/</code><code class="python plain">(x</code><code class="python keyword">+</code><code class="python value">1</code><code class="python plain">),</code><code class="python value">1.0</code><code class="python keyword">/</code><code class="python plain">math.sqrt(</code><code class="python value">2</code><code class="python keyword">*</code><code class="python plain">x</code><code class="python keyword">+</code><code class="python value">2</code><code class="python plain">))</code></div><div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python plain">i,x,y</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="python plain">gibbs()</code></div></div></td></tr></tbody></table></div></div>
<p>It can be run with a command like</p>
<div><div id="highlighter_938751" class="syntaxhighlighter nogutter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash functions">time</code> <code class="bash plain">python gibbs.py &gt; data.tab</code></div></div></td></tr></tbody></table></div></div>
<p>This code turns out to be noticeably faster than the R versions, taking around 4 minutes on my laptop (again, detailed timing information below). However, there is a project for python known as the <a href="http://pypy.org/">PyPy</a> project, which is concerned with compiling regular python code to very fast byte-code, giving significant speed-ups on certain problems. For this post, I downloaded and install version 1.5 of the 64-bit linux version of PyPy. Once installed, I can run the above code with the command</p>
<div><div id="highlighter_535118" class="syntaxhighlighter nogutter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash functions">time</code> <code class="bash plain">pypy gibbs.py &gt; data.tab</code></div></div></td></tr></tbody></table></div></div>
<p>To my astonishment, this “just worked”, and gave very impressive speed-up over regular python, running in around 30 seconds. This actually makes python a much more realistic prospect for the development of MCMC codes than I imagined. However, I need to understand the limitations of PyPy better – for example, why doesn’t everyone always use PyPy for everything?! It certainly seems to make python look like a very good option for <i>prototyping</i> MCMC codes.</p>
<h4>C</h4>
<p>Traditionally, I have mainly written MCMC codes in C, using the <a href="http://www.gnu.org/software/gsl/">GSL</a>. C is a fast, efficient, statically typed language, which compiles to native code. In many ways it represents the “gold standard” for speed. So, here is the C code for this problem.</p>
<div><div id="highlighter_300099" class="syntaxhighlighter  cpp"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp preprocessor">#include &lt;stdio.h&gt;</code></div><div class="line number2 index1 alt1"><code class="cpp preprocessor">#include &lt;math.h&gt;</code></div><div class="line number3 index2 alt2"><code class="cpp preprocessor">#include &lt;stdlib.h&gt;</code></div><div class="line number4 index3 alt1"><code class="cpp preprocessor">#include &lt;gsl/gsl_rng.h&gt;</code></div><div class="line number5 index4 alt2"><code class="cpp preprocessor">#include &lt;gsl/gsl_randist.h&gt;</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="cpp keyword bold">void</code> <code class="cpp plain">main()</code></div><div class="line number8 index7 alt1"><code class="cpp plain">{</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">N=50000;</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">thin=1000;</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">i,j;</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp plain">gsl_rng *r = gsl_rng_alloc(gsl_rng_mt19937);</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp color1 bold">double</code> <code class="cpp plain">x=0;</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp color1 bold">double</code> <code class="cpp plain">y=0;</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"Iter x y\n"</code><code class="cpp plain">);</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code> <code class="cpp plain">(i=0;i&lt;N;i++) {</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code> <code class="cpp plain">(j=0;j&lt;thin;j++) {</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">x=gsl_ran_gamma(r,3.0,1.0/(y*y+4));</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">y=1.0/(x+1)+gsl_ran_gaussian(r,1.0/</code><code class="cpp functions bold">sqrt</code><code class="cpp plain">(2*x+2));</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"%d %f %f\n"</code><code class="cpp plain">,i,x,y);</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number23 index22 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>It can be compiled and run with command like</p>
<div><div id="highlighter_852946" class="syntaxhighlighter nogutter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash functions">gcc</code> <code class="bash plain">-O4 gibbs.c -lgsl -lgslcblas -lm -o gibbs</code></div><div class="line number2 index1 alt1"><code class="bash functions">time</code> <code class="bash plain">.</code><code class="bash plain">/gibbs</code> <code class="bash plain">&gt; datac.tab</code></div></div></td></tr></tbody></table></div></div>
<p>This runs faster than anything else I consider in this post, taking around 8 seconds.</p>
<h4>Java</h4>
<p>I’ve recently been experimenting with <a href="http://www.java.com/">Java</a> for MCMC codes, in conjunction with <a href="http://sourceforge.net/projects/parallelcolt/">Parallel COLT</a>. Java is a statically typed object-oriented (O-O) language, but is usually compiled to byte-code to run on a virtual machine (known as the JVM). Java compilers and virtual machines are very fast these days, giving “close to C” performance, but with a nicer programming language, and advantages associated with virtual machines. Portability is a huge advantage of Java. For example, I can easily get my Java code to run on almost any University Condor pool, on both Windows and Linux clusters – they all have a recent JVM installed, and I can easily bundle any required libraries with my code. Suffice to say that getting GSL/C code to run on generic Condor pools is typically much less straightforward. Here is the Java code:</p>
<div><div id="highlighter_514867" class="syntaxhighlighter  java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">import</code> <code class="java plain">java.util.*;</code></div><div class="line number2 index1 alt1"><code class="java keyword">import</code> <code class="java plain">cern.jet.random.tdouble.*;</code></div><div class="line number3 index2 alt2"><code class="java keyword">import</code> <code class="java plain">cern.jet.random.tdouble.engine.*;</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="java keyword">class</code> <code class="java plain">Gibbs</code></div><div class="line number6 index5 alt1"><code class="java plain">{</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java keyword">static</code> <code class="java keyword">void</code> <code class="java plain">main(String[] arg)</code></div><div class="line number9 index8 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">{</code></div><div class="line number10 index9 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">int</code> <code class="java plain">N=</code><code class="java value">50000</code><code class="java plain">;</code></div><div class="line number11 index10 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">int</code> <code class="java plain">thin=</code><code class="java value">1000</code><code class="java plain">;</code></div><div class="line number12 index11 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">DoubleRandomEngine rngEngine=</code><code class="java keyword">new</code> <code class="java plain">DoubleMersenneTwister(</code><code class="java keyword">new</code> <code class="java plain">Date());</code></div><div class="line number13 index12 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Normal rngN=</code><code class="java keyword">new</code> <code class="java plain">Normal(</code><code class="java value">0.0</code><code class="java plain">,</code><code class="java value">1.0</code><code class="java plain">,rngEngine);</code></div><div class="line number14 index13 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Gamma rngG=</code><code class="java keyword">new</code> <code class="java plain">Gamma(</code><code class="java value">1.0</code><code class="java plain">,</code><code class="java value">1.0</code><code class="java plain">,rngEngine);</code></div><div class="line number15 index14 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">double</code> <code class="java plain">x=</code><code class="java value">0</code><code class="java plain">;</code></div><div class="line number16 index15 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">double</code> <code class="java plain">y=</code><code class="java value">0</code><code class="java plain">;</code></div><div class="line number17 index16 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">System.out.println(</code><code class="java string">"Iter x y"</code><code class="java plain">);</code></div><div class="line number18 index17 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">for</code> <code class="java plain">(</code><code class="java keyword">int</code> <code class="java plain">i=</code><code class="java value">0</code><code class="java plain">;i&lt;N;i++) {</code></div><div class="line number19 index18 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">for</code> <code class="java plain">(</code><code class="java keyword">int</code> <code class="java plain">j=</code><code class="java value">0</code><code class="java plain">;j&lt;thin;j++) {</code></div><div class="line number20 index19 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">x=rngG.nextDouble(</code><code class="java value">3.0</code><code class="java plain">,y*y+</code><code class="java value">4</code><code class="java plain">);</code></div><div class="line number21 index20 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">y=rngN.nextDouble(</code><code class="java value">1.0</code><code class="java plain">/(x+</code><code class="java value">1</code><code class="java plain">),</code><code class="java value">1.0</code><code class="java plain">/Math.sqrt(</code><code class="java value">2</code><code class="java plain">*x+</code><code class="java value">2</code><code class="java plain">));</code></div><div class="line number22 index21 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number23 index22 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">System.out.println(i+</code><code class="java string">" "</code><code class="java plain">+x+</code><code class="java string">" "</code><code class="java plain">+y);</code></div><div class="line number24 index23 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number25 index24 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number26 index25 alt1">&nbsp;</div><div class="line number27 index26 alt2"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>It can be compiled and run with</p>
<div><div id="highlighter_197615" class="syntaxhighlighter nogutter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">javac Gibbs.java</code></div><div class="line number2 index1 alt1"><code class="bash functions">time</code> <code class="bash plain">java Gibbs &gt; data.tab</code></div></div></td></tr></tbody></table></div></div>
<p>This takes around 11.6s seconds on my laptop. This is well within a factor of 2 of the C version, and around 3 times faster than even the PyPy python version. It is around 40 times faster than R. Java looks like a good choice for implementing MCMC codes that would be messy to implement in C, or that need to run places where it would be fiddly to get native codes to run.</p>
<h4>Scala</h4>
<p>Another language I’ve been taking some interest in recently is <a href="http://www.scala-lang.org/">Scala</a>. Scala is a statically typed O-O/functional language which compiles to byte-code that runs on the JVM. Since it uses Java technology, it can seamlessly integrate with Java libraries, and can run anywhere that Java code can run. It is a much nicer language to program in than Java, and feels more like a dynamic language such as python. In fact, it is almost as nice to program in as python (and in some ways nicer), and will run in a lot more places than PyPy python code. Here is the scala code (which calls Parallel COLT for random number generation):</p>
<div><div id="highlighter_893428" class="syntaxhighlighter  scala"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="scala keyword">object</code> <code class="scala plain">GibbsSc {</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="scala spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="scala keyword">import</code> <code class="scala plain">cern.jet.random.tdouble.engine.DoubleMersenneTwister</code></div><div class="line number4 index3 alt1"><code class="scala spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="scala keyword">import</code> <code class="scala plain">cern.jet.random.tdouble.Normal</code></div><div class="line number5 index4 alt2"><code class="scala spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="scala keyword">import</code> <code class="scala plain">cern.jet.random.tdouble.Gamma</code></div><div class="line number6 index5 alt1"><code class="scala spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="scala keyword">import</code> <code class="scala plain">Math.sqrt</code></div><div class="line number7 index6 alt2"><code class="scala spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="scala keyword">import</code> <code class="scala plain">java.util.Date</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="scala spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="scala keyword">def</code> <code class="scala plain">main(args</code><code class="scala keyword">:</code> <code class="scala plain">Array[String]) {</code></div><div class="line number10 index9 alt1"><code class="scala spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="scala keyword">val</code> <code class="scala plain">N</code><code class="scala keyword">=</code><code class="scala value">50000</code></div><div class="line number11 index10 alt2"><code class="scala spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="scala keyword">val</code> <code class="scala plain">thin</code><code class="scala keyword">=</code><code class="scala value">1000</code></div><div class="line number12 index11 alt1"><code class="scala spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="scala keyword">val</code> <code class="scala plain">rngEngine</code><code class="scala keyword">=</code><code class="scala keyword">new</code> <code class="scala plain">DoubleMersenneTwister(</code><code class="scala keyword">new</code> <code class="scala plain">Date)</code></div><div class="line number13 index12 alt2"><code class="scala spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="scala keyword">val</code> <code class="scala plain">rngN</code><code class="scala keyword">=</code><code class="scala keyword">new</code> <code class="scala plain">Normal(</code><code class="scala value">0.0</code><code class="scala plain">,</code><code class="scala value">1.0</code><code class="scala plain">,rngEngine)</code></div><div class="line number14 index13 alt1"><code class="scala spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="scala keyword">val</code> <code class="scala plain">rngG</code><code class="scala keyword">=</code><code class="scala keyword">new</code> <code class="scala plain">Gamma(</code><code class="scala value">1.0</code><code class="scala plain">,</code><code class="scala value">1.0</code><code class="scala plain">,rngEngine)</code></div><div class="line number15 index14 alt2"><code class="scala spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="scala keyword">var</code> <code class="scala plain">x</code><code class="scala keyword">=</code><code class="scala value">0.0</code></div><div class="line number16 index15 alt1"><code class="scala spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="scala keyword">var</code> <code class="scala plain">y</code><code class="scala keyword">=</code><code class="scala value">0.0</code></div><div class="line number17 index16 alt2"><code class="scala spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="scala plain">println(</code><code class="scala string">"Iter x y"</code><code class="scala plain">)</code></div><div class="line number18 index17 alt1"><code class="scala spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="scala keyword">for</code> <code class="scala plain">(i &lt;- </code><code class="scala value">0</code> <code class="scala plain">until N) {</code></div><div class="line number19 index18 alt2"><code class="scala spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="scala keyword">for</code> <code class="scala plain">(j &lt;- </code><code class="scala value">0</code> <code class="scala plain">until thin) {</code></div><div class="line number20 index19 alt1"><code class="scala spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="scala plain">x</code><code class="scala keyword">=</code><code class="scala plain">rngG.nextDouble(</code><code class="scala value">3.0</code><code class="scala plain">,y*y+</code><code class="scala value">4</code><code class="scala plain">)</code></div><div class="line number21 index20 alt2"><code class="scala spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="scala plain">y</code><code class="scala keyword">=</code><code class="scala plain">rngN.nextDouble(</code><code class="scala value">1.0</code><code class="scala plain">/(x+</code><code class="scala value">1</code><code class="scala plain">),</code><code class="scala value">1.0</code><code class="scala plain">/sqrt(</code><code class="scala value">2</code><code class="scala plain">*x+</code><code class="scala value">2</code><code class="scala plain">))</code></div><div class="line number22 index21 alt1"><code class="scala spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="scala plain">}</code></div><div class="line number23 index22 alt2"><code class="scala spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="scala plain">println(i+</code><code class="scala string">" "</code><code class="scala plain">+x+</code><code class="scala string">" "</code><code class="scala plain">+y)</code></div><div class="line number24 index23 alt1"><code class="scala spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="scala plain">}</code></div><div class="line number25 index24 alt2"><code class="scala spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="scala plain">}</code></div><div class="line number26 index25 alt1">&nbsp;</div><div class="line number27 index26 alt2"><code class="scala plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>It can be compiled and run with</p>
<div><div id="highlighter_369330" class="syntaxhighlighter nogutter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">scalac GibbsSc.scala</code></div><div class="line number2 index1 alt1"><code class="bash functions">time</code> <code class="bash plain">scala GibbsSc &gt; data.tab</code></div></div></td></tr></tbody></table></div></div>
<p>This code takes around 11.8s on my laptop – almost as fast as the Java code! So, on the basis of this very simple and superficial example, it looks like scala may offer the best of all worlds – a nice, elegant, terse programming language, functional and O-O programming styles, the safety of static typing, the ability to call on Java libraries, great speed and efficiency, and the portability of Java! Very interesting.</p>
<h4>Groovy</h4>
<p>James Durbin has kindly sent me a <a href="http://groovy.codehaus.org/">Groovy</a> version of the code, which he has also discussed in his own <a href="http://bayesianconspiracy.blogspot.com/2011/07/gibbs-sampler-in-groovy_25.html">blog post</a>. Groovy is a dynamic O-O language for the JVM, which, like Scala, can integrate nicely with Java applications. It isn’t a language I have examined closely, but it seems quite nice. The code is given below:</p>
<div><div id="highlighter_152662" class="syntaxhighlighter  groovy"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="groovy keyword">import</code> <code class="groovy plain">cern.jet.random.tdouble.engine.*;</code></div><div class="line number2 index1 alt1"><code class="groovy keyword">import</code> <code class="groovy plain">cern.jet.random.tdouble.*;</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="groovy plain">N=</code><code class="groovy value">50000</code><code class="groovy plain">;</code></div><div class="line number5 index4 alt2"><code class="groovy plain">thin=</code><code class="groovy value">1000</code><code class="groovy plain">;</code></div><div class="line number6 index5 alt1"><code class="groovy plain">rngEngine= </code><code class="groovy keyword">new</code> <code class="groovy plain">DoubleMersenneTwister(</code><code class="groovy keyword">new</code> <code class="groovy plain">Date());</code></div><div class="line number7 index6 alt2"><code class="groovy plain">rngN=</code><code class="groovy keyword">new</code> <code class="groovy plain">Normal(</code><code class="groovy value">0.0</code><code class="groovy plain">,</code><code class="groovy value">1.0</code><code class="groovy plain">,rngEngine);</code></div><div class="line number8 index7 alt1"><code class="groovy plain">rngG=</code><code class="groovy keyword">new</code> <code class="groovy plain">Gamma(</code><code class="groovy value">1.0</code><code class="groovy plain">,</code><code class="groovy value">1.0</code><code class="groovy plain">,rngEngine);</code></div><div class="line number9 index8 alt2"><code class="groovy plain">x=</code><code class="groovy value">0.0</code><code class="groovy plain">;</code></div><div class="line number10 index9 alt1"><code class="groovy plain">y=</code><code class="groovy value">0.0</code><code class="groovy plain">;</code></div><div class="line number11 index10 alt2"><code class="groovy functions">println</code><code class="groovy plain">(</code><code class="groovy string">"Iter x y"</code><code class="groovy plain">);</code></div><div class="line number12 index11 alt1"><code class="groovy plain">for(i </code><code class="groovy keyword">in</code> <code class="groovy value">1</code><code class="groovy plain">..N){</code></div><div class="line number13 index12 alt2"><code class="groovy spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="groovy plain">for(j </code><code class="groovy keyword">in</code> <code class="groovy value">1</code><code class="groovy plain">..thin){</code></div><div class="line number14 index13 alt1"><code class="groovy spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="groovy plain">x=rngG.nextDouble(</code><code class="groovy value">3.0</code><code class="groovy plain">,y*y+</code><code class="groovy value">4</code><code class="groovy plain">);</code></div><div class="line number15 index14 alt2"><code class="groovy spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="groovy plain">y=rngN.nextDouble(</code><code class="groovy value">1.0</code><code class="groovy plain">/(x+</code><code class="groovy value">1</code><code class="groovy plain">),</code><code class="groovy value">1.0</code><code class="groovy plain">/Math.sqrt(</code><code class="groovy value">2</code><code class="groovy plain">*x+</code><code class="groovy value">2</code><code class="groovy plain">));</code></div><div class="line number16 index15 alt1"><code class="groovy spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="groovy plain">}</code></div><div class="line number17 index16 alt2"><code class="groovy spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="groovy functions">println</code><code class="groovy plain">(</code><code class="groovy string">"$i $x $y"</code><code class="groovy plain">);</code></div><div class="line number18 index17 alt1"><code class="groovy plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>It can be run with a command like:</p>
<div><div id="highlighter_361743" class="syntaxhighlighter nogutter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash functions">time</code> <code class="bash plain">groovy Gibbs.gv &gt; data.tab</code></div></div></td></tr></tbody></table></div></div>
<p>Again, rather amazingly, this code runs in around 35 seconds – very similar to the speed of PyPy. This makes Groovy also seem like a potential very attractive environment for prototyping MCMC codes, especially if I’m thinking about ultimately porting to Java.</p>
<h3>Timings</h3>
<p>The laptop I’m running everything on is a Dell Precision M4500 with an Intel i7 Quad core (x940@2.13Ghz) CPU, running the 64-bit version of Ubuntu 11.04. I’m running stuff from the Ubuntu (Unity) desktop, and running several terminals and applications, but the machine is not loaded at the time each job runs. I’m running each job 3 times and taking the arithmetic mean real elapsed time. All timings are in seconds.</p>
<table>
<tbody><tr>
<td>R 2.12.1 (in memory)</td>
<td>435.0</td>
</tr>
<tr>
<td>R 2.12.1 (script)</td>
<td>450.2</td>
</tr>
<tr>
<td>Python 2.7.1+</td>
<td>233.5</td>
</tr>
<tr>
<td>PyPy 1.5</td>
<td>32.2</td>
</tr>
<tr>
<td>Groovy 1.7.4</td>
<td>35.4</td>
</tr>
<tr>
<td>Java 1.6.0</td>
<td>11.6</td>
</tr>
<tr>
<td>Scala 2.7.7</td>
<td>11.8</td>
</tr>
<tr>
<td>C (gcc 4.5.2)</td>
<td>8.1</td>
</tr>
</tbody></table>
<p>If we look at speed-up relative to the R code (in-memory version), we get:</p>
<table>
<tbody><tr>
<td>R (in memory)</td>
<td>1.00</td>
</tr>
<tr>
<td>R (script)</td>
<td>0.97</td>
</tr>
<tr>
<td>Python</td>
<td>1.86</td>
</tr>
<tr>
<td>PyPy</td>
<td>13.51</td>
</tr>
<tr>
<td>Groovy</td>
<td>12.3</td>
</tr>
<tr>
<td>Java</td>
<td>37.50</td>
</tr>
<tr>
<td>Scala</td>
<td>36.86</td>
</tr>
<tr>
<td>C</td>
<td>53.70</td>
</tr>
</tbody></table>
<p>Alternatively, we can look at slow-down relative to the C version, to get:</p>
<table>
<tbody><tr>
<td>R (in memory)</td>
<td>53.7</td>
</tr>
<tr>
<td>R (script)</td>
<td>55.6</td>
</tr>
<tr>
<td>Python</td>
<td>28.8</td>
</tr>
<tr>
<td>PyPy</td>
<td>4.0</td>
</tr>
<tr>
<td>Groovy</td>
<td>4.4</td>
</tr>
<tr>
<td>Java</td>
<td>1.4</td>
</tr>
<tr>
<td>Scala</td>
<td>1.5</td>
</tr>
<tr>
<td>C</td>
<td>1.0</td>
</tr>
</tbody></table>
<h3>Discussion</h3>
<p>The findings here are generally consistent with those of the old post, but consideration of PyPy, Groovy and Scala does throw up some new issues. I was pretty stunned by PyPy. First, I didn’t expect that it would “just work” – I thought I would either have to spend time messing around with my configuration settings, or possibly even have to modify my code slightly. Nope. Running python code with pypy appears to be more than 10 times faster than R, and only 4 times slower than C. I find it quite amazing that it is possible to get python code to run just 4 times slower than C, and if that is indicative of more substantial examples, it really does open up the possibility of using python for “real” problems, although library coverage is currently a problem. It certainly solves my “prototyping problem”. I often like to prototype algorithms in very high level dynamic languages like R and python before porting to a more efficient language. However, I have found that this doesn’t always work well with complex MCMC codes, as they just run too slowly in the dynamic languages to develop, test and debug conveniently. But it looks now as though PyPy should be fast enough at least for prototyping purposes, and may even be fast enough for production code in some circumstances. But then again, exactly the same goes for Groovy, which runs on the JVM, and can access any existing Java library… I haven’t yet looked into Groovy in detail, but it appears that it could be a very nice language for prototyping algorithms that I intend to port to Java.</p>
<p>The results also confirm my previous findings that Java is now “fast enough” that one shouldn’t worry too much about the difference in speed between it and native code written in C (or C++). The Java language is much nicer than C or C++, and the JVM platform is very attractive in many situations. However, the Scala results were also very surprising for me. Scala is a really elegant language (certainly on a par with python), comes with all of the advantages of Java, and appears to be almost as fast as Java. I’m really struggling to come up with reasons <i>not</i> to use Scala for everything!</p>
<h4>Speeding up R</h4>
<p>MCMC codes are used by a range of different scientists for a range of different problems. However, they are very (most?) often used by Bayesian statisticians who use the algorithms to target a Bayesian posterior distribution. For various (good) reasons, many statisticians are heavily invested in R, like to use R as much as possible, and do as much as possible from within the R environment. These results show why R is not a good language in which to implement MCMC algorithms, so what is an R-dependent statistician supposed to do? One possibility would be to byte-code compile R code in an analogous way to python and pypy. The very latest versions of R support such functionality, but <a href="http://dirk.eddelbuettel.com/blog/2011/07/14/#rcpp_gibbs_example">the post</a> by Dirk Eddelbuettel suggests that the current version of <tt>cmpfun</tt> will only give a 40% speedup on this problem, which is still slower than regular python code. Short of a dramatic improvement in this technology, the only way forward seems to be to extend R using code from another language. It is easy to extend R using C, C++ and Java. I have shown in previous posts how to do this <a href="https://darrenjw.wordpress.com/2011/01/01/calling-java-code-from-r/">using Java</a> and <a href="https://darrenjw.wordpress.com/2010/12/30/calling-c-code-from-r/">using C</a>, and the recent post by Dirk shows how to extend <a href="http://dirk.eddelbuettel.com/blog/2011/07/14/#rcpp_gibbs_example">using C++</a>. Although interesting, this doesn’t really have much bearing on the current discussion. If you extend using Java you get Java-like speedups, and if you extend using C you get C-like speedups. However, in case people are interested, I intend to gather up these examples into one post and include detailed timing information in a subsequent post.</p>
		<div class="wpcnt">
			<div class="wpa wpmrec">
				<a class="wpa-about" href="https://wordpress.com/about-these-ads/" rel="nofollow">About these ads</a>
				<div class="u">
					<script type="text/javascript">
					(function(g){g.__ATA.initAd({sectionId:26942, width:300, height:250});})(window);
					</script><div id="automattic-id-1240" data-section="26942" style="width:300px; height:250px;"></div>
				</div>
			</div>
		</div><div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" data-shared="sharing-twitter-533" class="share-twitter sd-button share-icon" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?share=twitter&nb=1" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow" data-shared="sharing-facebook-533" class="share-facebook sd-button share-icon" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?share=facebook&nb=1" target="_blank" title="Share on Facebook"><span>Facebook<span class="share-count">17</span></span></a></li><li class="share-linkedin"><a rel="nofollow" data-shared="sharing-linkedin-533" class="share-linkedin sd-button share-icon" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?share=linkedin&nb=1" target="_blank" title="Click to share on LinkedIn"><span>LinkedIn<span class="share-count">4</span></span></a></li><li class="share-reddit"><a rel="nofollow" data-shared="" class="share-reddit sd-button share-icon" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?share=reddit&nb=1" target="_blank" title="Click to share on Reddit"><span>Reddit</span></a></li><li class="share-google-plus-1"><a rel="nofollow" data-shared="sharing-google-533" class="share-google-plus-1 sd-button share-icon" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?share=google-plus-1&nb=1" target="_blank" title="Click to share on Google+"><span>Google</span></a></li><li class="share-end"></li></ul></div></div></div><div class="sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-loaded" id="like-post-wrapper-8820167-533-565f6ed03ec65" data-src="//widgets.wp.com/likes/#blog_id=8820167&amp;post_id=533&amp;origin=darrenjw.wordpress.com&amp;obj_id=8820167-533-565f6ed03ec65" data-name="like-post-frame-8820167-533-565f6ed03ec65"><h3 class="sd-title">Like this:</h3><div class="likes-widget-placeholder post-likes-widget-placeholder" style="height: 55px; display: none;"><span class="button"><span>Like</span></span> <span class="loading">Loading...</span></div><iframe class="post-likes-widget jetpack-likes-widget" name="like-post-frame-8820167-533-565f6ed03ec65" height="55px" width="100%" frameborder="0" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/saved_resource(9).html"></iframe><span class="sd-text-color"></span><a class="sd-link-color"></a></div>
<div id="jp-relatedposts" class="jp-relatedposts" style="display: block;">
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
<div class="jp-relatedposts-items jp-relatedposts-items-minimal"><p class="jp-relatedposts-post jp-relatedposts-post0" data-post-id="77" data-post-format="false"><span class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://darrenjw.wordpress.com/2010/04/28/mcmc-programming-in-r-python-java-and-c/" title="MCMC programming in R, Python, Java and C

EDIT 16/7/11 - this post has now been largely superceded by a new post! MCMC Markov chain Monte Carlo (MCMC) is a powerful simulation technique for exploring high-dimensional probability distributions. It is particularly useful for exploring posterior probability distributions that arise in Bayesian statistics. Although there are some generic tools…" rel="nofollow" data-origin="533" data-position="0">MCMC programming in R, Python, Java and C</a></span><span class="jp-relatedposts-post-context">In "MCMC programming R Python C Java GSL scipy COLT Monte Carlo"</span></p><p class="jp-relatedposts-post jp-relatedposts-post1" data-post-id="871" data-post-format="false"><span class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://darrenjw.wordpress.com/2011/12/30/catalogue-of-my-first-25-blog-posts/" title="Catalogue of my first 25 blog posts

This is my 25th blog post, so this seems like a good time to provide an index to those first 25 posts for ease of reference. I&#39;ve covered a range of topics over my first two years of blogging, and managed to average almost one post per month, as suggested…" rel="nofollow" data-origin="533" data-position="1">Catalogue of my first 25 blog posts</a></span><span class="jp-relatedposts-post-context">With 1 comment</span></p><p class="jp-relatedposts-post jp-relatedposts-post2" data-post-id="589" data-post-format="false"><span class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://darrenjw.wordpress.com/2011/07/31/faster-gibbs-sampling-mcmc-from-within-r/" title="Faster Gibbs sampling MCMC from within R

Introduction This post follows on from the previous post on Gibbs sampling in various languages. In that post a simple Gibbs sampler was implemented in various languages, and speeds were compared. It was seen that R is very slow for iterative simulation algorithms characteristic of MCMC methods such as the…" rel="nofollow" data-origin="533" data-position="2">Faster Gibbs sampling MCMC from within R</a></span><span class="jp-relatedposts-post-context">In "API"</span></p></div></div></div>	</div><!-- .entry-content -->

	
<div class="author-info">
	<h2 class="author-heading">Published by</h2>
	<div class="author-avatar">
		<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/65099774d1b07d97740c13e5c543a9f5" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-65099774d1b07d97740c13e5c543a9f5-0">	</div><!-- .author-avatar -->

	<div class="author-description">
		<h3 class="author-title">darrenjw</h3>

		<p class="author-bio">
			I am Professor of Stochastic Modelling within the School of Mathematics &amp; Statistics at Newcastle University, UK. I am also a computational systems biologist.			<a class="author-link" href="https://darrenjw.wordpress.com/author/darrenjw/" rel="author">
				View all posts by darrenjw			</a>
		</p><!-- .author-bio -->

	</div><!-- .author-description -->
</div><!-- .author-info -->

	<footer class="entry-footer">
		<span class="posted-on"><span class="screen-reader-text">Posted on </span><a href="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog.html" rel="bookmark"><time class="entry-date published" datetime="2011-07-16T16:03:42+00:00">16/07/2011</time><time class="updated" datetime="2014-11-12T17:29:03+00:00">12/11/2014</time></a></span><span class="byline"><span class="author vcard"><span class="screen-reader-text">Author </span><a class="url fn n" href="https://darrenjw.wordpress.com/author/darrenjw/">darrenjw</a></span></span><span class="tags-links"><span class="screen-reader-text">Tags </span><a href="https://darrenjw.wordpress.com/tag/byte-code/" rel="tag">byte-code</a>, <a href="https://darrenjw.wordpress.com/tag/c/" rel="tag">C</a>, <a href="https://darrenjw.wordpress.com/tag/colt/" rel="tag">COLT</a>, <a href="https://darrenjw.wordpress.com/tag/gibbs/" rel="tag">Gibbs</a>, <a href="https://darrenjw.wordpress.com/tag/groovy/" rel="tag">groovy</a>, <a href="https://darrenjw.wordpress.com/tag/gsl/" rel="tag">GSL</a>, <a href="https://darrenjw.wordpress.com/tag/java/" rel="tag">Java</a>, <a href="https://darrenjw.wordpress.com/tag/mcmc/" rel="tag">MCMC</a>, <a href="https://darrenjw.wordpress.com/tag/parallel/" rel="tag">parallel</a>, <a href="https://darrenjw.wordpress.com/tag/programming/" rel="tag">programming</a>, <a href="https://darrenjw.wordpress.com/tag/pypy/" rel="tag">pypy</a>, <a href="https://darrenjw.wordpress.com/tag/python/" rel="tag">python</a>, <a href="https://darrenjw.wordpress.com/tag/r/" rel="tag">R</a>, <a href="https://darrenjw.wordpress.com/tag/random/" rel="tag">random</a>, <a href="https://darrenjw.wordpress.com/tag/rcpp/" rel="tag">Rcpp</a>, <a href="https://darrenjw.wordpress.com/tag/relative/" rel="tag">relative</a>, <a href="https://darrenjw.wordpress.com/tag/rjava/" rel="tag">rJava</a>, <a href="https://darrenjw.wordpress.com/tag/sampler/" rel="tag">sampler</a>, <a href="https://darrenjw.wordpress.com/tag/scala/" rel="tag">scala</a>, <a href="https://darrenjw.wordpress.com/tag/speed/" rel="tag">speed</a>, <a href="https://darrenjw.wordpress.com/tag/timings/" rel="tag">timings</a></span>			</footer><!-- .entry-footer -->

</article><!-- #post-## -->

<div id="comments" class="comments-area">

			<h2 class="comments-title">
			51 thoughts on “Gibbs sampler in various languages&nbsp;(revisited)”		</h2>

		
		<ol class="comment-list">
					<li id="comment-240" class="pingback even thread-even depth-1 highlander-comment">
			<div class="comment-body">
				Pingback: <a href="https://darrenjw.wordpress.com/2010/04/28/mcmc-programming-in-r-python-java-and-c/" rel="external nofollow" class="url">MCMC programming in R, Python, Java and C « Darren Wilkinson's research blog</a> 			</div>
</li><!-- #comment-## -->
		<li id="comment-242" class="comment odd alt thread-odd thread-alt depth-1 parent highlander-comment">
			<article id="div-comment-242" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/b59786522b6b3610b96d82444ee93ac3" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-b59786522b6b3610b96d82444ee93ac3-0">						<b class="fn">Dave</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-242">
							<time datetime="2011-07-16T17:52:22+00:00">
								16/07/2011 at 17:52							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Have you tried using Bugs for MCMC?  Seems like many textbooks that use R also use Bugs to improve performance on MCMC.</p>
<p>And have you tried using REvolution instead of just R?  REvolution can take advantage of multithreading on Intels:<br>
<a href="http://blog.revolutionanalytics.com/2010/06/performance-benefits-of-multithreaded-r.html" rel="nofollow">http://blog.revolutionanalytics.com/2010/06/performance-benefits-of-multithreaded-r.html</a></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=242#respond" onclick="return addComment.moveForm( &quot;div-comment-242&quot;, &quot;242&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to Dave">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-243" class="comment byuser comment-author-darrenjw comment-author-is-site-member bypostauthor even depth-2 highlander-comment">
			<article id="div-comment-243" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/65099774d1b07d97740c13e5c543a9f5" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-65099774d1b07d97740c13e5c543a9f5-1">						<b class="fn"><a href="http://www.staff.ncl.ac.uk/d.j.wilkinson/" rel="external nofollow" class="url">darrenjw</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-243">
							<time datetime="2011-07-16T19:32:05+00:00">
								16/07/2011 at 19:32							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Yes, Bugs and OpenBugs can both be useful for relatively simple problems. As can JAGS and rjags, which I tend to use in preference. I keep meaning to do a post on JAGS and rjags, but haven’t yet got around to it. But there are many problems where these off-the-shelf solutions are not adequate.</p>
<p>Regarding multithreading and R, you don’t need to use Revolution R to exploit multiple cores. Multicore R stuff is another post on my list… But you don’t get even 4x speedup on your average quad-core machine, and you can multithread Java and Scala code, too…</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=243#respond" onclick="return addComment.moveForm( &quot;div-comment-243&quot;, &quot;243&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to darrenjw">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-244" class="comment odd alt thread-even depth-1 highlander-comment">
			<article id="div-comment-244" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/edcdfd5affb524e0f88ec1a00ed3fe5d" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-edcdfd5affb524e0f88ec1a00ed3fe5d-0">						<b class="fn"><a href="http://gravatar.com/alexgaynor" rel="external nofollow" class="url">alexgaynor Gaynor</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-244">
							<time datetime="2011-07-16T21:17:38+00:00">
								16/07/2011 at 21:17							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>If you thought PyPy 1.5 was good, wait until you see what we have cooking for our next release <span class="wp-smiley wp-emoji wp-emoji-smile" title=":)">:)</span>  On my system our current trunk was about 33% faster than 1.5.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=244#respond" onclick="return addComment.moveForm( &quot;div-comment-244&quot;, &quot;244&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to alexgaynor Gaynor">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-245" class="comment even thread-odd thread-alt depth-1 parent highlander-comment">
			<article id="div-comment-245" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/2f2ca3900ef33896dbd5d158c803d4bd" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-2f2ca3900ef33896dbd5d158c803d4bd-0">						<b class="fn"><a href="http://cfbolz.de/" rel="external nofollow" class="url">Carl Friedrich Bolz</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-245">
							<time datetime="2011-07-16T21:22:04+00:00">
								16/07/2011 at 21:22							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Very interesting comparison. It’s rare to find real-world code that is implemented across different languages.</p>
<p>Thanks for the kind words for PyPy (I’m one of the devs). A reason for not using PyPy everywhere is that it does not support all extension modules that work with CPython.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=245#respond" onclick="return addComment.moveForm( &quot;div-comment-245&quot;, &quot;245&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to Carl Friedrich Bolz">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-248" class="comment byuser comment-author-darrenjw comment-author-is-site-member bypostauthor odd alt depth-2 parent highlander-comment">
			<article id="div-comment-248" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/65099774d1b07d97740c13e5c543a9f5" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-65099774d1b07d97740c13e5c543a9f5-2">						<b class="fn"><a href="http://www.staff.ncl.ac.uk/d.j.wilkinson/" rel="external nofollow" class="url">darrenjw</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-248">
							<time datetime="2011-07-17T07:47:58+00:00">
								17/07/2011 at 07:47							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Yes, I guessed that module coverage would be an issue. Do you happen to know what the coverage of numpy/scipy is like?</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=248#respond" onclick="return addComment.moveForm( &quot;div-comment-248&quot;, &quot;248&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to darrenjw">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-249" class="comment even depth-3 highlander-comment">
			<article id="div-comment-249" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/2f2ca3900ef33896dbd5d158c803d4bd" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-2f2ca3900ef33896dbd5d158c803d4bd-1">						<b class="fn"><a href="http://cfbolz.de/" rel="external nofollow" class="url">Carl Friedrich Bolz</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-249">
							<time datetime="2011-07-17T07:51:06+00:00">
								17/07/2011 at 07:51							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Not good yet. Both of them are not supported so far. However, there are efforts underway to implement numpy together with good JIT support for numpy arrays. scipy will have to come after that. Around end of this year things might look much better in this regard. These modules are basically most often requested, so there’s a big incentive to work on them <span class="wp-smiley wp-emoji wp-emoji-smile" title=":-)">:-)</span>.</p>
				</div><!-- .comment-content -->

							</article><!-- .comment-body -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-246" class="pingback odd alt thread-even depth-1 highlander-comment">
			<div class="comment-body">
				Pingback: <a href="http://xcorr.net/2011/07/16/gibbs-sampler-in-matlab-using-mexme/" rel="external nofollow" class="url">Gibbs sampler in Matlab using mexme « xcorr: computational neuroscience</a> 			</div>
</li><!-- #comment-## -->
		<li id="comment-247" class="comment byuser comment-author-xcorr even thread-odd thread-alt depth-1 highlander-comment">
			<article id="div-comment-247" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/8def40ab2d48a7561a0ef948486334a2" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-8def40ab2d48a7561a0ef948486334a2-0">						<b class="fn">xcorr</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-247">
							<time datetime="2011-07-16T21:43:43+00:00">
								16/07/2011 at 21:43							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>While we’re at it, here’s the mex version for Matlab: <a href="http://xcorr.net/2011/07/16/gibbs-sampler-in-matlab-using-mexme/" rel="nofollow">http://xcorr.net/2011/07/16/gibbs-sampler-in-matlab-using-mexme/</a>. Conclusion: mex has very little overhead.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=247#respond" onclick="return addComment.moveForm( &quot;div-comment-247&quot;, &quot;247&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to xcorr">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-250" class="comment odd alt thread-even depth-1 parent highlander-comment">
			<article id="div-comment-250" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/3bc530a80bd7c88a69bebb49acf5b925" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-3bc530a80bd7c88a69bebb49acf5b925-0">						<b class="fn">Daniel Duckworth</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-250">
							<time datetime="2011-07-18T16:47:09+00:00">
								18/07/2011 at 16:47							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi Darren,</p>
<p>Thanks for the post!  It’s nice to see someone implement some scientific computation code across multiple languages to give a real-world speed comparison.</p>
<p>I just wanted to note that Scala and Java, though basically equivalent in speed here, should not necessarily be considered on the same footing in practice due to the simplicity of your code.  That’s not to say that if you throw something more complex at Scala it will massively falter, but I wouldn’t expect it to be 1-to-1 with Java in all situations.  </p>
<p>That said, I very much appreciate this post!</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=250#respond" onclick="return addComment.moveForm( &quot;div-comment-250&quot;, &quot;250&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to Daniel Duckworth">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-251" class="comment byuser comment-author-darrenjw comment-author-is-site-member bypostauthor even depth-2 highlander-comment">
			<article id="div-comment-251" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/65099774d1b07d97740c13e5c543a9f5" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-65099774d1b07d97740c13e5c543a9f5-3">						<b class="fn"><a href="http://www.staff.ncl.ac.uk/d.j.wilkinson/" rel="external nofollow" class="url">darrenjw</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-251">
							<time datetime="2011-07-18T16:50:55+00:00">
								18/07/2011 at 16:50							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Very true, and that goes for all of the languages. All that these comparisons really tell us about is speed of basic random number generation and loops. That is interesting in itself, but not the whole story.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=251#respond" onclick="return addComment.moveForm( &quot;div-comment-251&quot;, &quot;251&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to darrenjw">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-252" class="comment odd alt thread-odd thread-alt depth-1 parent highlander-comment">
			<article id="div-comment-252" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/d9e0ea5863a3cee8a31febd8494ca6e7" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-d9e0ea5863a3cee8a31febd8494ca6e7-0">						<b class="fn">Tim Salimans</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-252">
							<time datetime="2011-07-20T16:18:29+00:00">
								20/07/2011 at 16:18							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Interesting post!</p>
<p>Here is a Matlab version:</p>
<p>%///////////////////////////////////////////////////<br>
function gibbs(n,thin)</p>
<p>x=0;<br>
y=0;</p>
<p>for i=1:n<br>
    gammarands=randg(3,thin,1);<br>
    normrands=randn(thin,1);<br>
    for j=1:thin<br>
        x=(y^2+4)*gammarands(j);<br>
        y=1/(1+x)+normrands(j)/sqrt(2*x+2);<br>
    end<br>
end<br>
end</p>
<p>tic<br>
gibbs(5e4,1e3);<br>
toc<br>
%///////////////////////////////////////////////////</p>
<p>On my pc this runs in under 10 seconds (due to JIT compilation).</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=252#respond" onclick="return addComment.moveForm( &quot;div-comment-252&quot;, &quot;252&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to Tim Salimans">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-255" class="comment byuser comment-author-darrenjw comment-author-is-site-member bypostauthor even depth-2 highlander-comment">
			<article id="div-comment-255" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/65099774d1b07d97740c13e5c543a9f5" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-65099774d1b07d97740c13e5c543a9f5-4">						<b class="fn"><a href="http://www.staff.ncl.ac.uk/d.j.wilkinson/" rel="external nofollow" class="url">darrenjw</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-255">
							<time datetime="2011-07-28T10:13:54+00:00">
								28/07/2011 at 10:13							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks. Of course, you have used a couple of tricks there which I deliberately didn’t include in my examples, in order to try and be “fair” to the various languages. Also, I don’t think you can just ignore the issue of recording the output in this example. The Matlab examples are interesting, but obviously Matlab isn’t free software, and can be difficult to use in distributed and cloud computing environments.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=255#respond" onclick="return addComment.moveForm( &quot;div-comment-255&quot;, &quot;255&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to darrenjw">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-256" class="comment byuser comment-author-darrenjw comment-author-is-site-member bypostauthor odd alt thread-even depth-1 highlander-comment">
			<article id="div-comment-256" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/65099774d1b07d97740c13e5c543a9f5" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-65099774d1b07d97740c13e5c543a9f5-5">						<b class="fn"><a href="http://www.staff.ncl.ac.uk/d.j.wilkinson/" rel="external nofollow" class="url">darrenjw</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-256">
							<time datetime="2011-07-29T17:24:06+00:00">
								29/07/2011 at 17:24							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Update: 29/7/11. James Durbin has sent me a Groovy version of the code. Rather than trying to fudge this into a comment, or write another post, I’ve just edited the post to include the Groovy example. It looks very interesting!</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=256#respond" onclick="return addComment.moveForm( &quot;div-comment-256&quot;, &quot;256&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to darrenjw">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-258" class="pingback even thread-odd thread-alt depth-1 highlander-comment">
			<div class="comment-body">
				Pingback: <a href="https://darrenjw.wordpress.com/2011/07/31/faster-gibbs-sampling-mcmc-from-within-r/" rel="external nofollow" class="url">Faster Gibbs sampling MCMC from within R « Darren Wilkinson's research blog</a> 			</div>
</li><!-- #comment-## -->
		<li id="comment-261" class="comment odd alt thread-even depth-1 highlander-comment">
			<article id="div-comment-261" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/3bc530a80bd7c88a69bebb49acf5b925" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-3bc530a80bd7c88a69bebb49acf5b925-1">						<b class="fn">Daniel Duckworth</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-261">
							<time datetime="2011-07-31T23:59:05+00:00">
								31/07/2011 at 23:59							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>For those considering which language to implement their next scientific project in, I also recommend Language Shootout ( <a href="http://shootout.alioth.debian.org/" rel="nofollow">http://shootout.alioth.debian.org/</a> ).  It’s tests are based more on numerical computation that random number simulation, but it gives a clean, detailed view of how languages compare with that respect.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=261#respond" onclick="return addComment.moveForm( &quot;div-comment-261&quot;, &quot;261&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to Daniel Duckworth">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-415" class="comment even thread-odd thread-alt depth-1 highlander-comment">
			<article id="div-comment-415" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/2b37134235e21817f74cd8c47eb0538d" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-2b37134235e21817f74cd8c47eb0538d-0">						<b class="fn">Faheem Mitha</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-415">
							<time datetime="2011-12-12T05:12:15+00:00">
								12/12/2011 at 05:12							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>With pypy 1.7 I’m seeing more like a factor of 2 difference between C and pypy. Impressive.</p>
<p>$ time ./wilk &gt; datac.tab</p>
<p>real    0m25.026s<br>
user    0m23.577s<br>
sys     0m0.140s</p>
<p>$ time pypy wilk.py &gt; data_pypy.tab</p>
<p>real    0m46.510s<br>
user    0m44.591s<br>
sys     0m0.212s</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=415#respond" onclick="return addComment.moveForm( &quot;div-comment-415&quot;, &quot;415&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to Faheem Mitha">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-460" class="pingback odd alt thread-even depth-1 highlander-comment">
			<div class="comment-body">
				Pingback: <a href="https://darrenjw.wordpress.com/2011/12/30/catalogue-of-my-first-25-blog-posts/" rel="external nofollow" class="url">Catalogue of my first 25 blog posts « Darren Wilkinson's research blog</a> 			</div>
</li><!-- #comment-## -->
		<li id="comment-477" class="comment even thread-odd thread-alt depth-1 parent highlander-comment">
			<article id="div-comment-477" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/d72f2b8d6afc1a34f8a621218eef72a2" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-d72f2b8d6afc1a34f8a621218eef72a2-0">						<b class="fn"><a href="http://damon.is-a-geek.com/~damon" rel="external nofollow" class="url">Damon</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-477">
							<time datetime="2012-02-03T16:43:31+00:00">
								03/02/2012 at 16:43							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi,</p>
<p>I do a lot of sampling using C and noticed you used the Mersenne -Twister random number generator.</p>
<p>I just thought I’d point out that, in at least the most common applications, this algorithm is great for producing random numbers with a huge period. But with the huge period comes a sacrifice at computational cost. I personally use the gsl_rng_taus2 algorithm. It has a smaller period (but not so small that you will ever see these effects in practice) but it’s much faster at producing random numbers.</p>
<p>As a final note, the default algorithm for producing Gaussian random numbers in GSL is the Box-Müller algorithm, which is great. I use the Ziggurat algorithm, whose average behaviour is cheaper than that of Box-Müller and produces results almost as good.</p>
<p>Maybe some day I’ll write a comparison using those two methods in C.</p>
<p>Anyway, your article was a nice read. Thanks <span class="wp-smiley wp-emoji wp-emoji-smile" title=":)">:)</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=477#respond" onclick="return addComment.moveForm( &quot;div-comment-477&quot;, &quot;477&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to Damon">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-478" class="comment byuser comment-author-darrenjw comment-author-is-site-member bypostauthor odd alt depth-2 parent highlander-comment">
			<article id="div-comment-478" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/65099774d1b07d97740c13e5c543a9f5" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-65099774d1b07d97740c13e5c543a9f5-6">						<b class="fn"><a href="http://www.staff.ncl.ac.uk/d.j.wilkinson/" rel="external nofollow" class="url">darrenjw</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-478">
							<time datetime="2012-02-03T17:34:14+00:00">
								03/02/2012 at 17:34							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>You’re right about the MT being expensive – I know that Marsaglia is not a fan of it, but it is a “safe” choice, and it is implemented similarly in the GSL and Parallel COLT, which was important for “fair” comparison between Java and C. Same comment regarding use of Box-Muller for Gaussians, though I think PC actually caches the second variate and GSL doesn’t, which isn’t totally fair now I come to think of it…</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=478#respond" onclick="return addComment.moveForm( &quot;div-comment-478&quot;, &quot;478&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to darrenjw">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-479" class="comment even depth-3 highlander-comment">
			<article id="div-comment-479" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/d72f2b8d6afc1a34f8a621218eef72a2" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-d72f2b8d6afc1a34f8a621218eef72a2-1">						<b class="fn"><a href="http://damon.is-a-geek.com/~damon" rel="external nofollow" class="url">Damon</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-479">
							<time datetime="2012-02-03T17:42:17+00:00">
								03/02/2012 at 17:42							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I totally agree with you. You did the right thing by trying to use the same methods and RNGs in each case, of course. There’s a nice article on RNGs by David Jones at UCL called ‘Good Practice in (Pseudo) Random Number Generation for Bioinformatics Applications’.</p>
<p>For me, the take-home message (and probably for the wider, less programmy, audience) of Python and PyPy is nice.</p>
<p>Thanks again for an interesting article.</p>
				</div><!-- .comment-content -->

							</article><!-- .comment-body -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-491" class="pingback odd alt thread-even depth-1 highlander-comment">
			<div class="comment-body">
				Pingback: <a href="http://thebayesianobserver.wordpress.com/2012/02/24/machine-learning-and-programming-languages/" rel="external nofollow" class="url">Machine learning and Programming languages « The Bayesian Observer</a> 			</div>
</li><!-- #comment-## -->
		<li id="comment-492" class="pingback even thread-odd thread-alt depth-1 highlander-comment">
			<div class="comment-body">
				Pingback: <a href="http://www.datanalytics.com/blog/2012/03/06/mas-sobre-julia-ii-mi-primer-programa/" rel="external nofollow" class="url">datanalytics » Más sobre Julia (II): mi primer programa</a> 			</div>
</li><!-- #comment-## -->
		<li id="comment-500" class="pingback odd alt thread-even depth-1 highlander-comment">
			<div class="comment-body">
				Pingback: <a href="http://mylomowalk.wordpress.com/2012/04/07/gibbs-sampling-with-julia/" rel="external nofollow" class="url">Gibbs Sampling with Julia « mylomowalk</a> 			</div>
</li><!-- #comment-## -->
		<li id="comment-507" class="comment even thread-odd thread-alt depth-1 parent highlander-comment">
			<article id="div-comment-507" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/55ac4b194df8532a43192e23c02cc989" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-55ac4b194df8532a43192e23c02cc989-0">						<b class="fn">wrobell</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-507">
							<time datetime="2012-05-22T10:10:01+00:00">
								22/05/2012 at 10:10							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>what about python 3.x implementation? python 2.x creates a list when range(N) is called, so python 3.x might be bit faster…</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=507#respond" onclick="return addComment.moveForm( &quot;div-comment-507&quot;, &quot;507&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to wrobell">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-508" class="comment odd alt depth-2 highlander-comment">
			<article id="div-comment-508" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/d72f2b8d6afc1a34f8a621218eef72a2" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-d72f2b8d6afc1a34f8a621218eef72a2-2">						<b class="fn"><a href="http://damon-is-a-geek.com/" rel="external nofollow" class="url">Damon McDougall</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-508">
							<time datetime="2012-05-22T11:09:48+00:00">
								22/05/2012 at 11:09							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Python 2.x has that functionality, too. Just use xrange instead of range.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=508#respond" onclick="return addComment.moveForm( &quot;div-comment-508&quot;, &quot;508&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to Damon McDougall">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-512" class="pingback even thread-even depth-1 highlander-comment">
			<div class="comment-body">
				Pingback: <a href="https://darrenjw.wordpress.com/2012/06/01/gibbs-sampling-a-gaussian-markov-random-field-gmrf-using-java/" rel="external nofollow" class="url">Gibbs sampling a Gaussian Markov random field (GMRF) using Java « Darren Wilkinson's research blog</a> 			</div>
</li><!-- #comment-## -->
		<li id="comment-519" class="pingback odd alt thread-odd thread-alt depth-1 highlander-comment">
			<div class="comment-body">
				Pingback: <a href="http://quantlabs.net/blog/2012/06/real-world-comparison-of-monte-carlo-gibbs-simulations-for-hft-between-c-c-java-python-r-scala-and-groovy/" rel="external nofollow" class="url">Real world comparison of Monte Carlo Gibbs simulations for HFT between C, C++, Java, Python, R, Scala, and Groovy? | QUANTLABS.NET</a> 			</div>
</li><!-- #comment-## -->
		<li id="comment-533" class="pingback even thread-even depth-1 highlander-comment">
			<div class="comment-body">
				Pingback: <a href="http://civilstat.com/?p=419" rel="external nofollow" class="url">useR 2012: main conference braindump | Civil Statistician</a> 			</div>
</li><!-- #comment-## -->
		<li id="comment-539" class="pingback odd alt thread-odd thread-alt depth-1 highlander-comment">
			<div class="comment-body">
				Pingback: <a href="https://darrenjw.wordpress.com/2012/07/07/mcmc-on-the-raspberry-pi/" rel="external nofollow" class="url">MCMC on the Raspberry Pi « Darren Wilkinson's research blog</a> 			</div>
</li><!-- #comment-## -->
		<li id="comment-574" class="comment even thread-even depth-1 parent highlander-comment">
			<article id="div-comment-574" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/4981bc0d1f524d5d2780d1640d85ec88" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-4981bc0d1f524d5d2780d1640d85ec88-0">						<b class="fn">Danny Williamson</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-574">
							<time datetime="2012-07-11T17:05:57+00:00">
								11/07/2012 at 17:05							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I’ve recently been interested in coding expensive algorithms in different languages and this was a very interesting post. I’ve coded up the R, Python, C (in C++) and Java programs on Max Os X Snow Leopard and can report similar timings.</p>
<p>I am still, however, a little skeptical about Java. One of the largest and trickiest operations in an MCMC or any large Bayesian calculation can be the construction, multiplication and decomposition of large matrices. Colt, at least, is very slow at simple matrix operations in comparison to R, Python and C. For example the guy here: <a href="http://stackoverflow.com/questions/529457/performance-of-java-matrix-math-libraries" rel="nofollow">http://stackoverflow.com/questions/529457/performance-of-java-matrix-math-libraries</a> tries multiplying a 3000×3000 matrix with itself in C++, R, Python and Java using Colt and parallel colt (and some other languages and packages). He reported that whilst the first three took around 4 seconds, Colt took 150! </p>
<p>Have you worked with a Java package that can match the efficiency of these other languages for matrix operations?</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=574#respond" onclick="return addComment.moveForm( &quot;div-comment-574&quot;, &quot;574&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to Danny Williamson">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-575" class="comment byuser comment-author-darrenjw comment-author-is-site-member bypostauthor odd alt depth-2 parent highlander-comment">
			<article id="div-comment-575" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/65099774d1b07d97740c13e5c543a9f5" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-65099774d1b07d97740c13e5c543a9f5-7">						<b class="fn"><a href="http://www.staff.ncl.ac.uk/d.j.wilkinson/" rel="external nofollow" class="url">darrenjw</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-575">
							<time datetime="2012-07-11T17:24:24+00:00">
								11/07/2012 at 17:24							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>If large matrix computations really are your bottleneck, then you will need to use an optimised native BLAS. As mentioned in the SO thread you point at, using JBLAS with Java is then just as fast as other platforms which call out to the BLAS (though I’ve not used it). But calling out to native code removes some of the attraction of Java, and if that really is your bottleneck, you are probably fine with Python or R anyway.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=575#respond" onclick="return addComment.moveForm( &quot;div-comment-575&quot;, &quot;575&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to darrenjw">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-576" class="comment even depth-3 highlander-comment">
			<article id="div-comment-576" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/4981bc0d1f524d5d2780d1640d85ec88" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-4981bc0d1f524d5d2780d1640d85ec88-1">						<b class="fn">Danny Williamson</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-576">
							<time datetime="2012-07-11T17:37:55+00:00">
								11/07/2012 at 17:37							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Well the bottleneck in R is usually the loop which contains matrix operations. Suppose, for example, you have an MCMC for a Gaussian process with a prior distribution on the correlation lengths. To evaluate the likelihood for any proposed new correlation lengths will require the construction and cholesky decomposition of a possibly large variance matrix. So the matrix bit is probably fast, but it happens inside a big loop, which of course is slow in R. The pypy package looks exciting but I havn’t tested to see if it is compatible with packages that allow for fast cholesky decompositions in python for example.</p>
				</div><!-- .comment-content -->

							</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-577" class="comment byuser comment-author-darrenjw comment-author-is-site-member bypostauthor odd alt depth-3 highlander-comment">
			<article id="div-comment-577" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/65099774d1b07d97740c13e5c543a9f5" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-65099774d1b07d97740c13e5c543a9f5-8">						<b class="fn"><a href="http://www.staff.ncl.ac.uk/d.j.wilkinson/" rel="external nofollow" class="url">darrenjw</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-577">
							<time datetime="2012-07-11T17:49:07+00:00">
								11/07/2012 at 17:49							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Yes – these are precisely the kinds of problems that first drove me to C and subsequently to Java. I think you should try Java and see how you get on! My guess is that it will be fine, and that using JBLAS will buy you performance over PColt, but hurt you in portability. The trouble with pypy (if I understand correctly) is that it can’t easily call out to native code, so the actual matrix operations will be slower than calling out to an optimised native BLAS…</p>
				</div><!-- .comment-content -->

							</article><!-- .comment-body -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-579" class="comment even thread-odd thread-alt depth-1 highlander-comment">
			<article id="div-comment-579" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/4981bc0d1f524d5d2780d1640d85ec88" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-4981bc0d1f524d5d2780d1640d85ec88-2">						<b class="fn">Danny Williamson</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-579">
							<time datetime="2012-07-11T19:17:31+00:00">
								11/07/2012 at 19:17							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I have repeated this excellent experiment on a Macbook pro 3.06GHz Inter Core 2 Duo with 8GB memory using Mac Os X 10.6.8 and included a version with COLT replacing ParallelColt for Java (as it is slightly better documented). I also used C++ instead of C. I thought it would be interesting to share my findings for two reasons. 1. It is interesting to see how the times compare (between languages) using a Mac and 2. Installing libraries and packages for coding on a Mac is never straightforward in my experience, so I wanted to check and report that it can be done (though with some effort!). The numbers are as follows:<br>
Language   Time (s)<br>
R (2.13.1)        682<br>
Python(2.6.1)   338<br>
pypy (1.9)        26.4<br>
Java (colt)       15.7<br>
Java (parallel)  12.4<br>
C++ (using g++) 7.1</p>
<p>It appears as though the Mac-version of this experiment has R much slower than the original (by nearly 3 minutes!), even though timings for the other languages are roughly the same if not slightly faster (possibly due to version updates).</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=579#respond" onclick="return addComment.moveForm( &quot;div-comment-579&quot;, &quot;579&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to Danny Williamson">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-688" class="comment odd alt thread-even depth-1 highlander-comment">
			<article id="div-comment-688" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/6208d3b8d4db284350cd2e7d328bbc72" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-6208d3b8d4db284350cd2e7d328bbc72-0">						<b class="fn">Giovanni Petris</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-688">
							<time datetime="2012-09-11T02:13:07+00:00">
								11/09/2012 at 02:13							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Dear Darren,</p>
<p>Thank you for your carefully discussed time comparison. I do a lot of MCMC, mostly in R. When I really have to, I write my C functions which I then call from R. I had been thinking about Python for some time and your post prompted me to give it a try. I wanted to confirm your timing results on a slightly more complicated model, so I decided to use a Normal regression model, in which the regressors are a factor with four levels and a numerical covariate. I have timed a fairly simple Gibbs sampler both in R and in Python, but to my surprise the outcome was the opposite of what I would have expected – and of what you reported in your post!</p>
<p>Here are the times.</p>
<p>gpetris$ time python firstGibbs.py &gt; gibbsPy.out</p>
<p>real	2m35.320s<br>
user	2m35.071s<br>
sys	0m0.214s</p>
<p>gpetris$ time Rscript firstGibbs.R &gt; gibbsR.out</p>
<p>real	0m27.881s<br>
user	0m27.444s<br>
sys	0m0.406s</p>
<p>Do you have any explanation for that?</p>
<p>The code for both versions, with the data set used in the example, can be found at definetti.uark.edu/~gpetris/Gibbs.</p>
<p>Thank you for any insight you can provide!</p>
<p>Best,<br>
Giovanni Petris</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=688#respond" onclick="return addComment.moveForm( &quot;div-comment-688&quot;, &quot;688&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to Giovanni Petris">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-974" class="comment even thread-odd thread-alt depth-1 highlander-comment">
			<article id="div-comment-974" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/88ed473b38d2939423068a90e80077e1" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-88ed473b38d2939423068a90e80077e1-0">						<b class="fn">Marcin Zamojski</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-974">
							<time datetime="2012-12-28T16:20:59+00:00">
								28/12/2012 at 16:20							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>The Python code does not show what is possible in CPython. For one printing results slows it down. ‘Import y’ and ‘y.x.’ is also slower than ‘from y import x’. And finally, ‘numpy.random’ is much quicker than ‘random’.</p>
<p>On my computer:<br>
Original function: 178.540799999<br>
Original function without prints: 169.056849999<br>
Numpy for random numbers, no prints: 44.8219899988</p>
<p>Numpypy does not have random implemented yet, so I couldn’t test it in PyPy.</p>
<p>The fastest code is:</p>
<p>    from numpy.random import gamma, randn<br>
    from math import sqrt</p>
<p>    def gibbs(N=50000,thin=1000):<br>
        x=0<br>
        y=0<br>
        res=[]<br>
        for i in xrange(N):<br>
            for j in xrange(thin):<br>
                x=gamma(3,1.0/(y**2+4))<br>
                y=randn()/sqrt(2*x+2)+1.0/(x+1)<br>
            res.append([i,x,y])</p>
<p>            res.append([i,x,y])<br>
        return res</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=974#respond" onclick="return addComment.moveForm( &quot;div-comment-974&quot;, &quot;974&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to Marcin Zamojski">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-976" class="comment odd alt thread-even depth-1 highlander-comment">
			<article id="div-comment-976" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/2b37134235e21817f74cd8c47eb0538d" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-2b37134235e21817f74cd8c47eb0538d-1">						<b class="fn">Faheem Mitha</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-976">
							<time datetime="2012-12-31T11:36:36+00:00">
								31/12/2012 at 11:36							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I just tested this example with Common Lisp (SBCL 1.1.2 on Debian squeeze), with cl-randist (see <a href="https://github.com/lvaruzza/cl-randist/" rel="nofollow">https://github.com/lvaruzza/cl-randist/</a> and <a href="http://www.cliki.net/cl-randist" rel="nofollow">http://www.cliki.net/cl-randist</a>), which is a pure CL implemention of random number distributions, supposedly based on GSL. With your same code, but with the printing removed, your C version clocks between 24 and 25 secs on my machine. The CL version is at around 18 sec. It is worth commenting (maybe someone has already done so) that these aren’t really fair comparisons, since the computation is dominated by the random distribution functions, and different languages probably use different algorithms, which might vary significantly in efficiency. A fair comparison might be to implement all these distribution functions using the same algorithm and in the host language. Of course, if this was done systematically, languages like Python would fare even worse in the comparison, as I bet the Python functions are written in C. I include the CL code below.</p>
<p>(defun lgibbs (N thin)<br>
  (declare (fixnum N thin))<br>
  (declare (optimize (speed 3) (debug 0) (safety 1)))<br>
  (let ((x 0.0) (y 0.0) (*print-pretty* nil))<br>
    (declare ((double-float 0.0 *) x))<br>
    (declare (double-float y))<br>
    ;;(print “Iter x y”)<br>
    (dotimes (i N)<br>
      (dotimes (j thin)<br>
	(declare (fixnum i j))<br>
	(setf x (cl-randist::random-gamma 3.0 (/ 1.0 (+ (* y y) 4))))<br>
	(setf y (cl-randist::random-normal (/ 1.0 (+ x 1.0)) (/ 1.0 (sqrt (+ (* 2 x) 2))))))<br>
      ;;(format t “~a ~a ~a~%” i x y)<br>
      )))</p>
<p>(defun main ()<br>
  (lgibbs 50000 1000))</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=976#respond" onclick="return addComment.moveForm( &quot;div-comment-976&quot;, &quot;976&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to Faheem Mitha">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-977" class="comment even thread-odd thread-alt depth-1 highlander-comment">
			<article id="div-comment-977" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/aa37fe476faf109f5ac68b64e8998e9f" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-aa37fe476faf109f5ac68b64e8998e9f-0">						<b class="fn">Christian</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-977">
							<time datetime="2013-01-02T00:29:00+00:00">
								02/01/2013 at 00:29							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Recently I found shedskin (<a href="http://code.google.com/p/shedskin/" rel="nofollow">http://code.google.com/p/shedskin/</a>) a nice C++ compiler for Python. Might be  usefuel for math code with standard libs ( 10x faster as py-code).</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=977#respond" onclick="return addComment.moveForm( &quot;div-comment-977&quot;, &quot;977&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to Christian">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-990" class="pingback odd alt thread-even depth-1 highlander-comment">
			<div class="comment-body">
				Pingback: <a href="http://darrenjw2.wordpress.com/2012/07/15/benchmarking-java-speed-on-the-raspberry-pi/" rel="external nofollow" class="url">Benchmarking Java speed on the Raspberry Pi | darrenjw's blog</a> 			</div>
</li><!-- #comment-## -->
		<li id="comment-1160" class="pingback even thread-odd thread-alt depth-1 highlander-comment">
			<div class="comment-body">
				Pingback: <a href="https://darrenjw.wordpress.com/2013/10/04/a-functional-gibbs-sampler-in-scala/" rel="external nofollow" class="url">A functional Gibbs sampler in Scala | Darren Wilkinson's research blog</a> 			</div>
</li><!-- #comment-## -->
		<li id="comment-1203" class="pingback odd alt thread-even depth-1 highlander-comment">
			<div class="comment-body">
				Pingback: <a href="https://darrenjw.wordpress.com/2013/12/23/scala-as-a-platform-for-statistical-computing-and-data-science/" rel="external nofollow" class="url">Scala as a platform for statistical computing and data science | Darren Wilkinson's research blog</a> 			</div>
</li><!-- #comment-## -->
		<li id="comment-1441" class="comment even thread-odd thread-alt depth-1 highlander-comment">
			<article id="div-comment-1441" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/photo.jpg" class="avatar avatar-56" height="56" width="56">						<b class="fn"><a href="https://plus.google.com/105915740243325856633" rel="external nofollow" class="url">David Cottrell</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-1441">
							<time datetime="2014-02-25T06:38:52+00:00">
								25/02/2014 at 06:38							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Was playing around in a notebook and using numpy instead of random seems to speed things up quite a bit (in Python): <a href="http://nbviewer.ipython.org/gist/anonymous/49a489f5e8c05796c0a4" rel="nofollow">http://nbviewer.ipython.org/gist/anonymous/49a489f5e8c05796c0a4</a> … The random module is pretty bare bones. Also a trivial hack with cython goes pretty far on my machine at least.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=1441#respond" onclick="return addComment.moveForm( &quot;div-comment-1441&quot;, &quot;1441&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to David Cottrell">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-1508" class="comment byuser comment-author-purenanya odd alt thread-even depth-1 highlander-comment">
			<article id="div-comment-1508" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/252a20273aca6fe585921d009bca5e88" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-252a20273aca6fe585921d009bca5e88-0">						<b class="fn"><a href="http://purenanya.wordpress.com/" rel="external nofollow" class="url">purenanya</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-1508">
							<time datetime="2014-03-05T06:29:24+00:00">
								05/03/2014 at 06:29							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Reblogged this on <a href="http://purenanya.wordpress.com/2014/03/04/gibbs-sampler-in-various-languages-revisited/" rel="nofollow">Wikia</a>.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=1508#respond" onclick="return addComment.moveForm( &quot;div-comment-1508&quot;, &quot;1508&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to purenanya">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-4264" class="comment even thread-odd thread-alt depth-1 parent highlander-comment">
			<article id="div-comment-4264" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/deb81eaeb0b335d21ef35bcf9134fbef" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-deb81eaeb0b335d21ef35bcf9134fbef-0">						<b class="fn"><a href="http://gravatar.com/billhinge" rel="external nofollow" class="url">billhinge</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-4264">
							<time datetime="2014-10-17T23:15:13+00:00">
								17/10/2014 at 23:15							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I came across your blog when I was looking for a code implementation to aid my understanding so thanks. I have implemented similar code in fortran for a prog on boltzman machines. I understand the code but I don’t understand where the initial equation of x y came from, why you chose gamma/gaussian distributions – could you choose others? – also how does the original equation provide parameters alpha and beta from the f(x,y) eqn. Finally, how do we know that the C Java, Python, R eqns implement gamma and gaussian distribution equivalently – which is correct ?</p>
<p>thanks<br>
Steve</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=4264#respond" onclick="return addComment.moveForm( &quot;div-comment-4264&quot;, &quot;4264&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to billhinge">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-4272" class="comment byuser comment-author-darrenjw comment-author-is-site-member bypostauthor odd alt depth-2 highlander-comment">
			<article id="div-comment-4272" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/65099774d1b07d97740c13e5c543a9f5" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-65099774d1b07d97740c13e5c543a9f5-9">						<b class="fn"><a href="http://www.staff.ncl.ac.uk/d.j.wilkinson/" rel="external nofollow" class="url">darrenjw</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-4272">
							<time datetime="2014-10-19T10:23:18+00:00">
								19/10/2014 at 10:23							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>The post isn’t really meant to be an introduction to MCMC, but to instead provide some code examples. It sounds like you should read an introduction to MCMC – I do have some old lecture notes on this: <a href="https://www.staff.ncl.ac.uk/d.j.wilkinson/teaching/mas451/notes.pdf" rel="nofollow">https://www.staff.ncl.ac.uk/d.j.wilkinson/teaching/mas451/notes.pdf</a> – which you might find useful. In short, I picked the f() that I did because I knew it would have Gaussian and gamma full-conditionals, and the constants are determined by the form of f().</p>
<p>There are lots of ways to test that random number generators are working correctly and are equivalent. eg. you can test the mean and variance of a large number of samples, quantiles of the empirical distributions, etc.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=4272#respond" onclick="return addComment.moveForm( &quot;div-comment-4272&quot;, &quot;4272&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to darrenjw">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-4277" class="comment even thread-even depth-1 highlander-comment">
			<article id="div-comment-4277" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/deb81eaeb0b335d21ef35bcf9134fbef" class="avatar avatar-56 grav-hashed grav-hijack" height="56" width="56" id="grav-deb81eaeb0b335d21ef35bcf9134fbef-1">						<b class="fn"><a href="http://gravatar.com/billhinge" rel="external nofollow" class="url">billhinge</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-4277">
							<time datetime="2014-10-19T15:02:21+00:00">
								19/10/2014 at 15:02							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks Darren</p>
<p>That’s some of the background info I had been looking for having previously treated some of the equations as black box solutions.</p>
<p>Just to clarify about equivalence of generators, I’m using Intel’s Fortran compiler and MKL library, they have a slightly different implementation to GNU for example. eg see bottom of <a href="https://software.intel.com/en-us/node/521882" rel="nofollow">https://software.intel.com/en-us/node/521882</a> vs GNU GSL. Also MKL implementation returns a vector as opposed to a singular value.<br>
I looked at some of the other implementations to verify what algorithm they were calculating (I found ifort was x2.5 times faster on the same backpropagation code with like for like O3 optimization in comparison to gnu gfortran)</p>
<p>For info my Fortran implementation was quite slow but this was probably because I was setting the MKL gamma vector length to 1 to calculate x then setting the vector length in the gaussian distribution to 1 in order to calc y. If Just use the two distributions to calculate 10 million unrelated samples it is extremely fast but unfortunately there is no cross relation between x and y. On my machine your C example came in at 7.9 s</p>
<p>Just for curiosity I plotted a sample of the calculated x , y values in excel and that was quite informative</p>
<p>regards<br>
Steve</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/?replytocom=4277#respond" onclick="return addComment.moveForm( &quot;div-comment-4277&quot;, &quot;4277&quot;, &quot;respond&quot;, &quot;533&quot; )" aria-label="Reply to billhinge">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-4571" class="pingback odd alt thread-odd thread-alt depth-1 highlander-comment">
			<div class="comment-body">
				Pingback: <a href="http://januverma.wordpress.com/2014/12/13/gibbs-sampling/" rel="external nofollow" class="url">Gibbs sampling – Random Inferences</a> 			</div>
</li><!-- #comment-## -->
		<li id="comment-4630" class="pingback even thread-even depth-1 highlander-comment">
			<div class="comment-body">
				Pingback: <a href="https://darrenjw2.wordpress.com/2014/12/23/mcmc-on-the-parallella/" rel="external nofollow" class="url">MCMC on the Parallella | darrenjw's blog</a> 			</div>
</li><!-- #comment-## -->
		<li id="comment-4901" class="pingback odd alt thread-odd thread-alt depth-1 highlander-comment">
			<div class="comment-body">
				Pingback: <a href="https://darrenjw2.wordpress.com/2012/07/02/benchmarking-python-speed-on-the-raspberry-pi/" rel="external nofollow" class="url">Benchmarking python speed on the Raspberry Pi | darrenjw's blog</a> 			</div>
</li><!-- #comment-## -->
		<li id="comment-4902" class="pingback even thread-even depth-1 highlander-comment">
			<div class="comment-body">
				Pingback: <a href="https://darrenjw2.wordpress.com/2012/06/29/floating-point-performance-of-the-raspberry-p/" rel="external nofollow" class="url">Floating point performance of the Raspberry Pi | darrenjw's blog</a> 			</div>
</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
	
	
					<div id="respond" class="comment-respond js">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="https://darrenjw.wordpress.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate="">
					<input type="hidden" id="highlander_comment_nonce" name="highlander_comment_nonce" value="6888b1e905"><input type="hidden" name="_wp_http_referer" value="/2011/07/16/gibbs-sampler-in-various-languages-revisited/">
<input type="hidden" name="hc_post_as" id="hc_post_as" value="guest">

<div class="comment-form-field comment-textarea">
	
	<div id="comment-form-comment"><textarea tabindex="-1" style="position: absolute; top: -999px; left: 0px; right: auto; bottom: auto; border: 0px; padding: 0px; box-sizing: content-box; word-wrap: break-word; overflow: hidden; transition: none; height: 0px !important; min-height: 0px !important; font-family: &#39;Noto Serif&#39;, serif; font-size: 14px; font-weight: 400; font-style: normal; letter-spacing: 0px; text-transform: none; text-decoration: none; word-spacing: 0px; text-indent: 0px; line-height: 23.5788px; width: 638.281px;" class="autosizejs "></textarea><textarea id="comment" name="comment" title="Enter your comment here..." placeholder="Enter your comment here..." style="height: 43px; overflow: hidden; word-wrap: break-word; resize: none;"></textarea></div>
</div>

<div id="comment-form-identity" style="display: none;">

	<div id="comment-form-nascar">
		<p>Fill in your details below or click an icon to log in:</p>
		<ul>
			<li class="selected" style="display:none;">
				<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-form-guest" id="postas-guest" title="Guest">
					<span></span>
				</a>
			</li>
			<li>
				<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-form-load-service:WordPress.com" id="postas-wordpress" title="WordPress.com">
					<span></span>
				</a>
			</li>
			<li>
				<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-form-load-service:Twitter" id="postas-twitter" title="Twitter">
					<span></span>
				</a>
			</li>
			<li>
				<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#comment-form-load-service:Facebook" id="postas-facebook" title="Facebook">
					<span></span>
				</a>
			</li>
			<li>
			<iframe id="googleplus-sign-in" name="googleplus-sign-in" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/saved_resource.html" width="24" height="24" scrolling="no" allowtransparency="true" seamless="seamless" frameborder="0"></iframe>
			</li>
		</ul>
	</div>

	<div id="comment-form-guest" class="comment-form-service selected">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
<a href="https://gravatar.com/site/signup/" target="_blank">				<img src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/ad516503a11cd5ca435acc9bb6523536" alt="Gravatar" width="25" class="no-grav">
</a>			</div>

				<div class="comment-form-fields">
				<div class="comment-form-field comment-form-email">
					<label for="email">Email <span class="required">(required)</span> <span class="nopublish">(Address never made public)</span></label>
					<div class="comment-form-input"><input id="email" name="email" type="email" value=""></div>
				</div>
				<div class="comment-form-field comment-form-author">
					<label for="author">Name <span class="required">(required)</span></label>
					<div class="comment-form-input"><input id="author" name="author" type="text" value=""></div>
				</div>
				<div class="comment-form-field comment-form-url">
					<label for="url">Website</label>
					<div class="comment-form-input"><input id="url" name="url" type="text" value=""></div>
				</div>
			</div>
	
		</div>
	</div>

	<div id="comment-form-wordpress" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/wplogo.png" alt="WordPress.com Logo" width="25" class="no-grav">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="wp_avatar" id="wordpress-avatar" class="comment-meta-wordpress" value="">
				<input type="hidden" name="wp_user_id" id="wordpress-user_id" class="comment-meta-wordpress" value="">
				<input type="hidden" name="wp_access_token" id="wordpress-access_token" class="comment-meta-wordpress" value="">
				<p class="comment-form-posting-as pa-wordpress"><strong></strong> You are commenting using your WordPress.com account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'wordpress' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-twitter" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/ad516503a11cd5ca435acc9bb6523536" alt="Twitter picture" width="25" class="no-grav">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="twitter_avatar" id="twitter-avatar" class="comment-meta-twitter" value="">
				<input type="hidden" name="twitter_user_id" id="twitter-user_id" class="comment-meta-twitter" value="">
				<input type="hidden" name="twitter_access_token" id="twitter-access_token" class="comment-meta-twitter" value="">
				<p class="comment-form-posting-as pa-twitter"><strong></strong> You are commenting using your Twitter account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'twitter' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-facebook" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/ad516503a11cd5ca435acc9bb6523536" alt="Facebook photo" width="25" class="no-grav">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="fb_avatar" id="facebook-avatar" class="comment-meta-facebook" value="">
				<input type="hidden" name="fb_user_id" id="facebook-user_id" class="comment-meta-facebook" value="">
				<input type="hidden" name="fb_access_token" id="facebook-access_token" class="comment-meta-facebook" value="">
				<p class="comment-form-posting-as pa-facebook"><strong></strong> You are commenting using your Facebook account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'facebook' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-googleplus" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/ad516503a11cd5ca435acc9bb6523536" alt="Google+ photo" width="25" class="no-grav">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="googleplus_avatar" id="googleplus-avatar" class="comment-meta-googleplus" value="">
				<input type="hidden" name="googleplus_user_id" id="googleplus-user_id" class="comment-meta-googleplus" value="">
				<input type="hidden" name="googleplus_access_token" id="googleplus-access_token" class="comment-meta-googleplus" value="">
				<p class="comment-form-posting-as pa-googleplus"><strong></strong> You are commenting using your Google+ account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'googleplus' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>


	<div id="comment-form-load-service" class="comment-form-service">
		<div class="comment-form-posting-as-cancel"><a href="javascript:HighlanderComments.cancelExternalWindow();">Cancel</a></div>
		<p>Connecting to %s</p>
	</div>

</div>

<script type="text/javascript">
var highlander_expando_javascript = function(){
	var input = document.createElement( 'input' ),
	    comment = jQuery( '#comment' );

	if ( 'placeholder' in input ) {
		comment.attr( 'placeholder', jQuery( '.comment-textarea label' ).remove().text() );
	}

	// Expando Mode: start small, then auto-resize on first click + text length
	jQuery( '#comment-form-identity' ).hide();
	jQuery( '#comment-form-subscribe' ).hide();
	jQuery( '#commentform .form-submit' ).hide();

	comment.css( { 'height':'10px' } ).one( 'focus', function() {
		var timer = setInterval( HighlanderComments.resizeCallback, 10 )
		jQuery( this ).animate( { 'height': HighlanderComments.initialHeight } ).delay( 100 ).queue( function(n) { clearInterval( timer ); HighlanderComments.resizeCallback(); n(); } );
		jQuery( '#comment-form-identity' ).slideDown();
		jQuery( '#comment-form-subscribe' ).slideDown();
		jQuery( '#commentform .form-submit' ).slideDown();
	});
}
jQuery(document).ready( highlander_expando_javascript );
</script>

<div id="comment-form-subscribe" style="display: none;">
	<p class="comment-subscription-form"><input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;" tabindex="6"> <label class="subscribe-label" id="subscribe-label" for="subscribe" style="display: inline;">Notify me of new comments via email.</label></p></div>




<p class="form-submit" style="display: none;"><input name="submit" type="submit" id="comment-submit" class="submit" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="533" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="0326eef486"></p>
<input type="hidden" name="genseq" value="1449094864">
<p style="display: none;"></p>				<input type="hidden" id="ak_js" name="ak_js" value="1449094865711"></form>
					</div><!-- #respond -->
		<div style="clear: both"></div>
</div><!-- .comments-area -->

	<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://darrenjw.wordpress.com/2011/06/04/java-math-libraries-and-monte-carlo-simulation-codes/" rel="prev"><span class="meta-nav" aria-hidden="true">Previous</span> <span class="screen-reader-text">Previous post:</span> <span class="post-title">Java math libraries and Monte Carlo simulation&nbsp;codes</span></a></div><div class="nav-next"><a href="https://darrenjw.wordpress.com/2011/07/31/faster-gibbs-sampling-mcmc-from-within-r/" rel="next"><span class="meta-nav" aria-hidden="true">Next</span> <span class="screen-reader-text">Next post:</span> <span class="post-title">Faster Gibbs sampling MCMC from within&nbsp;R</span></a></div></div>
	</nav>
		</main><!-- .site-main -->
	</div><!-- .content-area -->


	</div><!-- .site-content -->

	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="site-info">
			<a href="https://wordpress.com/themes/twentyfifteen/" title="Learn more about this theme">The Twenty Fifteen Theme</a>.			<a href="https://wordpress.com/?ref=footer_blog">Blog at WordPress.com</a>.
		</div><!-- .site-info -->
	</footer><!-- .site-footer -->

</div><!-- .site -->

<!-- wpcom_wp_footer -->
<div id="wpcom-follow-bubbles-jp_blogs_i_follow-2" class="wpcom-follow-bubbles"><div id="wpcom-bubble-jp_blogs_i_follow-2-1" class="wpcom-bubble wpcom-follow-bubble"><div class="bubble-txt"><a href="http://kbroman.wordpress.com/" class="bump-view" data-bump-view="bif">The stupidest thing...</a><p><small>Statistics, genetics, programming, academics</small></p></div></div><div id="wpcom-bubble-jp_blogs_i_follow-2-2" class="wpcom-bubble wpcom-follow-bubble"><div class="bubble-txt"><a href="http://radfordneal.wordpress.com/" class="bump-view" data-bump-view="bif">Radford Neal's blog</a><p></p></div></div><div id="wpcom-bubble-jp_blogs_i_follow-2-3" class="wpcom-bubble wpcom-follow-bubble"><div class="bubble-txt"><a href="http://johncarlosbaez.wordpress.com/" class="bump-view" data-bump-view="bif">Azimuth</a><p></p></div></div><div id="wpcom-bubble-jp_blogs_i_follow-2-4" class="wpcom-bubble wpcom-follow-bubble"><div class="bubble-txt"><a href="http://xianblog.wordpress.com/" class="bump-view" data-bump-view="bif">Xi'an's Og</a><p><small>an attempt at bloggin, nothing more...</small></p></div></div><div id="wpcom-bubble-jp_blogs_i_follow-2-5" class="wpcom-bubble wpcom-follow-bubble"><div class="bubble-txt"><a href="http://normaldeviate.wordpress.com/" class="bump-view" data-bump-view="bif">Normal Deviate</a><p><small>Thoughts on Statistics and Machine Learning</small></p></div></div></div><script type="text/javascript" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/gprofiles.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type="text/javascript" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/wpgroho.js"></script>

	<script>
		//initialize and attach hovercards to all gravatars
		jQuery( document ).ready( function( $ ) {

			if (typeof Gravatar === "undefined"){
				return;
			}

			if ( typeof Gravatar.init !== "function" ) {
				return;
			}			

			Gravatar.profile_cb = function( hash, id ) {
				WPGroHo.syncProfileData( hash, id );
			};
			Gravatar.my_hash = WPGroHo.my_hash;
			Gravatar.init( 'body', '#wp-admin-bar-my-account' );
		});
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-65099774d1b07d97740c13e5c543a9f5">
	</div>
	<div class="grofile-hash-map-b59786522b6b3610b96d82444ee93ac3">
	</div>
	<div class="grofile-hash-map-65099774d1b07d97740c13e5c543a9f5">
	</div>
	<div class="grofile-hash-map-edcdfd5affb524e0f88ec1a00ed3fe5d">
	</div>
	<div class="grofile-hash-map-2f2ca3900ef33896dbd5d158c803d4bd">
	</div>
	<div class="grofile-hash-map-8def40ab2d48a7561a0ef948486334a2">
	</div>
	<div class="grofile-hash-map-3bc530a80bd7c88a69bebb49acf5b925">
	</div>
	<div class="grofile-hash-map-d9e0ea5863a3cee8a31febd8494ca6e7">
	</div>
	<div class="grofile-hash-map-2b37134235e21817f74cd8c47eb0538d">
	</div>
	<div class="grofile-hash-map-d72f2b8d6afc1a34f8a621218eef72a2">
	</div>
	<div class="grofile-hash-map-55ac4b194df8532a43192e23c02cc989">
	</div>
	<div class="grofile-hash-map-4981bc0d1f524d5d2780d1640d85ec88">
	</div>
	<div class="grofile-hash-map-6208d3b8d4db284350cd2e7d328bbc72">
	</div>
	<div class="grofile-hash-map-88ed473b38d2939423068a90e80077e1">
	</div>
	<div class="grofile-hash-map-aa37fe476faf109f5ac68b64e8998e9f">
	</div>
	<div class="grofile-hash-map-4a2acaa53f994eddb928ea4c9bd45acb">
	</div>
	<div class="grofile-hash-map-252a20273aca6fe585921d009bca5e88">
	</div>
	<div class="grofile-hash-map-deb81eaeb0b335d21ef35bcf9134fbef">
	</div>
	</div>
<script type="text/javascript">
/* <![CDATA[ */
var HighlanderComments = {"loggingInText":"Logging In\u2026","submittingText":"Posting Comment\u2026","postCommentText":"Post Comment","connectingToText":"Connecting to %s","commentingAsText":"%1$s: You are commenting using your %2$s account.","logoutText":"Log Out","loginText":"Log In","connectURL":"https:\/\/darrenjw.wordpress.com\/public.api\/connect\/?action=request","logoutURL":"https:\/\/darrenjw.wordpress.com\/wp-login.php?action=logout&_wpnonce=55a198e8ca","homeURL":"https:\/\/darrenjw.wordpress.com\/","postID":"533","gravDefault":"identicon","enterACommentError":"Please enter a comment","enterEmailError":"Please enter your email address here","invalidEmailError":"Invalid email address","enterAuthorError":"Please enter your name here","gravatarFromEmail":"This picture will show whenever you leave a comment. Click to customize it.","logInToExternalAccount":"Log in to use details from one of these accounts.","change":"Change","changeAccount":"Change Account","comment_registration":"0","userIsLoggedIn":"","isJetpack":"0","text_direction":"ltr"};
/* ]]> */
</script>
<script type="text/javascript" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/saved_resource(4)"></script>

	<div id="bit" class="loggedout-follow-normal" style="bottom: -316px;">
		<a class="bsub" href="javascript:void(0)"><span id="bsub-text">Follow</span></a>
		<div id="bitsubscribe">

					<h3><label for="loggedout-follow-field">Follow “Darren Wilkinson's research blog”</label></h3>

			<form action="https://subscribe.wordpress.com/" method="post" accept-charset="utf-8" id="loggedout-follow">
			<p>Get every new post delivered to your Inbox.</p>

			<p id="loggedout-follow-error" style="display: none;"></p>

						<p class="bit-follow-count">Join 246 other followers</p>
			<p><input type="email" name="email" placeholder="Enter your email address" id="loggedout-follow-field"></p>

			<input type="hidden" name="action" value="subscribe">
			<input type="hidden" name="blog_id" value="8820167">
			<input type="hidden" name="source" value="https://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/">
			<input type="hidden" name="sub-type" value="loggedout-follow">

			<input type="hidden" id="_wpnonce" name="_wpnonce" value="03e08109a0"><input type="hidden" name="_wp_http_referer" value="/2011/07/16/gibbs-sampler-in-various-languages-revisited/">
			<p id="bsub-subscribe-button"><input type="submit" value="Sign me up"></p>
			</form>
					<div id="bsub-credit"><a href="https://wordpress.com/?ref=lof">Build a website with WordPress.com</a></div>
		</div><!-- #bitsubscribe -->
	</div><!-- #bit -->
<script type="text/javascript" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/widgets.js"></script>

	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/darrenjw.wordpress.com\/2011\/07\/16\/gibbs-sampler-in-various-languages-revisited\/":533};
	</script>
		<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-twitter' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-facebook' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-linkedin' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-google-plus-1' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomgoogle-plus-1', 'menubar=1,resizable=1,width=480,height=550' );
				return false;
			});
		});
		</script>
				<iframe src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/master.html" scrolling="no" id="likes-master" name="likes-master" style="display:none;"></iframe>
		<div id="likes-other-gravatars"><div class="likes-text"><span>%d</span> bloggers like this:</div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
		<script type="text/javascript">
		//<![CDATA[
			var jetpackLikesWidgetQueue = [];
			var jetpackLikesWidgetBatch = [];
			var jetpackLikesMasterReady = false;

			function JetpackLikespostMessage( message, target ) {
				if ( "string" === typeof message ){
					try{
						message = JSON.parse( message );
					}
					catch(e) {
						return;
					}
				}

				pm( {
					target: target,
					type: 'likesMessage',
					data: message,
					origin: '*'
				} );
			}

			function JetpackLikesBatchHandler() {
				var requests = [];
				jQuery( 'div.jetpack-likes-widget-unloaded' ).each( function( i ) {
					if ( jetpackLikesWidgetBatch.indexOf( this.id ) > -1 )
						return;
					jetpackLikesWidgetBatch.push( this.id );
					var regex = /like-(post|comment)-wrapper-(\d+)-(\d+)-(\w+)/;
					var match = regex.exec( this.id );
					if ( ! match || match.length != 5 )
						return;

					var info = {
						blog_id: match[2],
						width:   this.width
					};

					if ( 'post' == match[1] ) {
						info.post_id = match[3];
					} else if ( 'comment' == match[1] ) {
						info.comment_id = match[3];
					}

					info.obj_id = match[4];

					requests.push( info );
				});

				if ( requests.length > 0 ) {
					JetpackLikespostMessage( { event: 'initialBatch', requests: requests }, window.frames['likes-master'] );
				}
			}

			function JetpackLikesMessageListener( event ) {
				if ( "undefined" == typeof event.event )
					return;

				if ( 'masterReady' == event.event ) {
					jQuery( document ).ready( function() {
						jetpackLikesMasterReady = true;

						var stylesData = {
								event: 'injectStyles'
						};

						if ( jQuery( 'iframe.admin-bar-likes-widget' ).length > 0 ) {
							JetpackLikespostMessage( { event: 'adminBarEnabled' }, window.frames[ 'likes-master' ] );

							stylesData.adminBarStyles = {
								background: jQuery( '#wpadminbar .quicklinks li#wp-admin-bar-wpl-like > a' ).css( 'background' ),
								isRtl: ( 'rtl' == jQuery( '#wpadminbar' ).css( 'direction' ) )
							};
						}

						if ( !window.addEventListener )
							jQuery( '#wp-admin-bar-admin-bar-likes-widget' ).hide();

						stylesData.textStyles = {
							color: jQuery( '.sd-text-color').css( 'color' ),
							fontFamily: jQuery( '.sd-text-color' ).css( 'font-family' ),
							fontSize: jQuery( '.sd-text-color' ).css( 'font-size' ),
							direction: jQuery( '.sd-text-color' ).css( 'direction' ),
							fontWeight: jQuery( '.sd-text-color' ).css( 'font-weight' ),
							fontStyle: jQuery( '.sd-text-color' ).css( 'font-style' ),
							textDecoration: jQuery( '.sd-text-color' ).css('text-decoration')
						};

						stylesData.linkStyles = {
							color: jQuery( '.sd-link-color' ).css('color'),
							fontFamily: jQuery( '.sd-link-color' ).css('font-family'),
							fontSize: jQuery( '.sd-link-color' ).css('font-size'),
							textDecoration: jQuery( '.sd-link-color' ).css('text-decoration'),
							fontWeight: jQuery( '.sd-link-color' ).css( 'font-weight' ),
							fontStyle: jQuery( '.sd-link-color' ).css( 'font-style' )
						};

						JetpackLikespostMessage( stylesData, window.frames[ 'likes-master' ] );

						JetpackLikesBatchHandler();

						jQuery( document ).on( 'inview', 'div.jetpack-likes-widget-unloaded', function() {
							jetpackLikesWidgetQueue.push( this.id );
						});
					});
				}

				if ( 'showLikeWidget' == event.event ) {
					jQuery( '#' + event.id + ' .post-likes-widget-placeholder'  ).fadeOut( 'fast', function() {
						jQuery( '#' + event.id + ' .post-likes-widget' ).fadeIn( 'fast', function() {
							JetpackLikespostMessage( { event: 'likeWidgetDisplayed', blog_id: event.blog_id, post_id: event.post_id, obj_id: event.obj_id }, window.frames['likes-master'] );
						});
					});
				}

				if ( 'clickReblogFlair' == event.event ) {
					wpcom_reblog.toggle_reblog_box_flair( event.obj_id );
				}

				if ( 'showOtherGravatars' == event.event ) {
					var $container = jQuery( '#likes-other-gravatars' );
					var $list = $container.find( 'ul' );

					$container.hide();
					$list.html( '' );

					$container.find( '.likes-text span' ).text( event.total );

					jQuery.each( event.likers, function( i, liker ) {
						$list.append( '<li class="' + liker.css_class + '"><a href="' + liker.profile_URL + '" class="wpl-liker" rel="nofollow" target="_parent"><img src="' + liker.avatar_URL + '" alt="' + liker.name + '" width="30" height="30" style="padding-right: 3px;" /></a></li>');
					} );

					var offset = jQuery( "[name='" + event.parent + "']" ).offset();

					$container.css( 'left', offset.left + event.position.left - 10 + 'px' );
					$container.css( 'top', offset.top + event.position.top - 33 + 'px' );

					var rowLength = Math.floor( event.width / 37 );
					var height = ( Math.ceil( event.likers.length / rowLength ) * 37 ) + 13;
					if ( height > 204 ) {
						height = 204;
					}

					$container.css( 'height', height + 'px' );
					$container.css( 'width', rowLength * 37 - 7 + 'px' );

					$list.css( 'width', rowLength * 37 + 'px' );

					$container.fadeIn( 'slow' );

					var scrollbarWidth = $list[0].offsetWidth - $list[0].clientWidth;
					if ( scrollbarWidth > 0 ) {
						$container.width( $container.width() + scrollbarWidth );
						$list.width( $list.width() + scrollbarWidth );
					}
				}
			}

			pm.bind( 'likesMessage', function(e) { JetpackLikesMessageListener(e); } );

			jQuery( document ).click( function( e ) {
				var $container = jQuery( '#likes-other-gravatars' );

				if ( $container.has( e.target ).length === 0 ) {
					$container.fadeOut( 'slow' );
				}
			});

			function JetpackLikesWidgetQueueHandler() {
				var wrapperID;
				if ( ! jetpackLikesMasterReady ) {
					setTimeout( JetpackLikesWidgetQueueHandler, 500 );
					return;
				}

				if ( jetpackLikesWidgetQueue.length > 0 ) {
					// We may have a widget that needs creating now
					var found = false;
					while( jetpackLikesWidgetQueue.length > 0 ) {
						// Grab the first member of the queue that isn't already loading.
						wrapperID = jetpackLikesWidgetQueue.splice( 0, 1 )[0];
						if ( jQuery( '#' + wrapperID ).hasClass( 'jetpack-likes-widget-unloaded' ) ) {
							found = true;
							break;
						}
					}
					if ( ! found ) {
						setTimeout( JetpackLikesWidgetQueueHandler, 500 );
						return;
					}
				} else if ( jQuery( 'div.jetpack-likes-widget-unloaded' ).length > 0 ) {
					// Grab any unloaded widgets for a batch request
					JetpackLikesBatchHandler();

					// Get the next unloaded widget
					wrapperID = jQuery( 'div.jetpack-likes-widget-unloaded' ).first()[0].id;
					if ( ! wrapperID ) {
						// Everything is currently loaded
						setTimeout( JetpackLikesWidgetQueueHandler, 500 );
						return;
					}
				}

				if ( 'undefined' === typeof wrapperID ) {
					setTimeout( JetpackLikesWidgetQueueHandler, 500 );
					return;
				}

				var $wrapper = jQuery( '#' + wrapperID );
				$wrapper.find( 'iframe' ).remove();

				if ( $wrapper.hasClass( 'slim-likes-widget' ) ) {
					$wrapper.find( '.post-likes-widget-placeholder' ).after( "<iframe class='post-likes-widget jetpack-likes-widget' name='" + $wrapper.data( 'name' ) + "' height='22px' width='68px' frameBorder='0' scrolling='no' src='" + $wrapper.data( 'src' ) + "'></iframe>" );
				} else {
					$wrapper.find( '.post-likes-widget-placeholder' ).after( "<iframe class='post-likes-widget jetpack-likes-widget' name='" + $wrapper.data( 'name' ) + "' height='55px' width='100%' frameBorder='0' src='" + $wrapper.data( 'src' ) + "'></iframe>" );
				}

				$wrapper.removeClass( 'jetpack-likes-widget-unloaded' ).addClass( 'jetpack-likes-widget-loading' );

				$wrapper.find( 'iframe' ).load( function( e ) {
					var $iframe = jQuery( e.target );
					$wrapper.removeClass( 'jetpack-likes-widget-loading' ).addClass( 'jetpack-likes-widget-loaded' );

					JetpackLikespostMessage( { event: 'loadLikeWidget', name: $iframe.attr( 'name' ), width: $iframe.width() }, window.frames[ 'likes-master' ] );

					if ( $wrapper.hasClass( 'slim-likes-widget' ) ) {
						$wrapper.find( 'iframe' ).Jetpack( 'resizeable' );
					}
				});
				setTimeout( JetpackLikesWidgetQueueHandler, 250 );
			}
			JetpackLikesWidgetQueueHandler();
		//]]>
		</script>
<script type="text/javascript" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/form.js"></script>
<script type="text/javascript" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/saved_resource(5)"></script>
<script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "https://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "https://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?m=1363304414g&amp;ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<script type="text/javascript">
/* <![CDATA[ */
var screenReaderText = {"expand":"<span class=\"screen-reader-text\">expand child menu<\/span>","collapse":"<span class=\"screen-reader-text\">collapse child menu<\/span>"};
/* ]]> */
</script>
<script type="text/javascript">
/* <![CDATA[ */
var JetpackEmojiSettings = {"base_url":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/emoji\/twemoji\/"};
/* ]]> */
</script>
<script type="text/javascript">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/saved_resource(6)"></script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script><script src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/w.js" type="text/javascript" async="" defer=""></script>
<script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'8820167','blog_tz':'1','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'8820167','v':'wpcom','tz':'1','user_id':'0','post':'533','subd':'darrenjw'}]);
_stq.push(['extra', {'crypt':'UE5XaGUuOTlwaD85flAmcm1mcmZsaDhkV11YdWFnNncxc1tjZG9XVXhRTmIuSltuLkN1bEJtUlEyViUuP3EzXUVhJkhSdlZ5a1I0RXJJK3xqaTF3MEtzLGNTbltjc1daYkZdVXFEaXJ6T3lhQ3lhLS0sSiVoW0lpaFZGfixicXROcG9ITDBZfj92U0ZFOXpaT3J5Y3BXOVgwY3ZTY2QyMTVfX0kufHBGfEZPcERuWHUzdXljSE5vRjFdY3laei55NzBqLH4xaCUlQzJRYnQ4LFVIY3xial9vdUtXMy42VzNnb3Z+dTk0MS5BOGxiQ0ZbM3dtWTZpalJ+fjRNNF9GNy5yazE1PVJCUHx8V1s4XXh0MXNyTmxuTkFIelg9'}]);
_stq.push([ 'clickTrackerInit', '8820167', '533' ]);
	</script>
<noscript>&lt;img src="https://pixel.wp.com/b.gif?v=noscript" style="height:0px;width:0px;overflow:hidden" alt="" /&gt;</noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script>


<img src="./Gibbs sampler in various languages (revisited) _ Darren Wilkinson's research blog_files/g.gif" id="wpstats"></body></html>